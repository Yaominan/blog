
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../keepalived/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>linux相关 - blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
      <link rel="stylesheet" href="../../mkdocs/css/no-footer.css">
    
      <link rel="stylesheet" href="../../mkdocs/css/unordered-list-symbols.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="blog" class="md-header__button md-logo" aria-label="blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              linux相关
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="orange"  aria-label="切换至夜间模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="切换至夜间模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="orange"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Yaominan/Yaominan.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Yaominan.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
    
  
  文档

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../ME/me/" class="md-tabs__link">
        
  
  
    
  
  关于我

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="blog" class="md-nav__button md-logo" aria-label="blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Yaominan/Yaominan.github.io" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Yaominan.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    文档
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            文档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    linux相关
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    linux相关
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1.系统安装
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.系统安装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux系统相关
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      软件部署安装
    </span>
  </a>
  
    <nav class="md-nav" aria-label="软件部署安装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux_1" class="md-nav__link">
    <span class="md-ellipsis">
      Linux下软件安装的几种方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdk" class="md-nav__link">
    <span class="md-ellipsis">
      安装jdk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql" class="md-nav__link">
    <span class="md-ellipsis">
      安装mysql
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tomcat" class="md-nav__link">
    <span class="md-ellipsis">
      安装tomcat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="安装tomcat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tomcat_1" class="md-nav__link">
    <span class="md-ellipsis">
      源码安装tomcat
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2linux" class="md-nav__link">
    <span class="md-ellipsis">
      2.Linux系统调优
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.Linux系统调优">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selinux" class="md-nav__link">
    <span class="md-ellipsis">
      关闭selinux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      查看环境变量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      开机自启服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh" class="md-nav__link">
    <span class="md-ellipsis">
      设置ssh服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      设置命令行历史记录数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      锁定重要文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      隐藏系统版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      通配符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#top" class="md-nav__link">
    <span class="md-ellipsis">
      top
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      重要的环境变量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      网卡配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      软硬链接
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3raidlvm" class="md-nav__link">
    <span class="md-ellipsis">
      3.raid磁盘阵列与lvm逻辑卷管理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.raid磁盘阵列与lvm逻辑卷管理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raid" class="md-nav__link">
    <span class="md-ellipsis">
      raid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="raid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      部署磁盘阵列
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      损坏磁盘阵列及修复
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raid_1" class="md-nav__link">
    <span class="md-ellipsis">
      解除raid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lvm" class="md-nav__link">
    <span class="md-ellipsis">
      LVM逻辑卷管理器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LVM逻辑卷管理器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      部署逻辑卷
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      扩容逻辑卷
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      缩小逻辑卷
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      逻辑卷快照
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      删除逻辑卷
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4iptablesfirewalld" class="md-nav__link">
    <span class="md-ellipsis">
      4.iptables和firewalld防火墙
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.iptables和firewalld防火墙">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iptables" class="md-nav__link">
    <span class="md-ellipsis">
      iptables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewalld" class="md-nav__link">
    <span class="md-ellipsis">
      firewalld
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      图形管理工具
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      服务的访问控制列表
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cockpit" class="md-nav__link">
    <span class="md-ellipsis">
      Cockpit驾驶舱管理工具
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5ssh" class="md-nav__link">
    <span class="md-ellipsis">
      5.使用ssh服务管理远程主机
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.使用ssh服务管理远程主机">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      配置网卡服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      远程控制服务
    </span>
  </a>
  
    <nav class="md-nav" aria-label="远程控制服务">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      安全密钥验证
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      不间断会话服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      检索日志信息
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6apache" class="md-nav__link">
    <span class="md-ellipsis">
      6.使用apache服务部署静态网站
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.使用apache服务部署静态网站">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      网站服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      配置服务文件参数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selinux_1" class="md-nav__link">
    <span class="md-ellipsis">
      SELinux安全子系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      虚拟网站主机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache" class="md-nav__link">
    <span class="md-ellipsis">
      apache的访问控制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7vsftpd" class="md-nav__link">
    <span class="md-ellipsis">
      7.使用vsftpd服务传输文件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7.使用vsftpd服务传输文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      文件传输协议
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vsftpd" class="md-nav__link">
    <span class="md-ellipsis">
      vsftpd服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tftp" class="md-nav__link">
    <span class="md-ellipsis">
      TFTP简单文件传输协议
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8sambanfs" class="md-nav__link">
    <span class="md-ellipsis">
      8.使用samba/NFS实现文件共享
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8.使用samba/NFS实现文件共享">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#samba" class="md-nav__link">
    <span class="md-ellipsis">
      samba文件共享服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nfs" class="md-nav__link">
    <span class="md-ellipsis">
      NFS网络文件系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autofs" class="md-nav__link">
    <span class="md-ellipsis">
      autofs自动挂载
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9bind" class="md-nav__link">
    <span class="md-ellipsis">
      9.使用bind提供域名解析服务
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.使用bind提供域名解析服务">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      DNS域名解析服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind" class="md-nav__link">
    <span class="md-ellipsis">
      安装Bind服务程序
    </span>
  </a>
  
    <nav class="md-nav" aria-label="安装Bind服务程序">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-ip" class="md-nav__link">
    <span class="md-ellipsis">
      正向解析（域名-&gt;IP）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip-" class="md-nav__link">
    <span class="md-ellipsis">
      反向解析（IP-&gt;域名）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      部署从服务器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      安全的加密传输
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      部署缓存服务器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10dhcp" class="md-nav__link">
    <span class="md-ellipsis">
      10.使用DHCP动态管理主机地址
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.使用DHCP动态管理主机地址">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhcpd" class="md-nav__link">
    <span class="md-ellipsis">
      部署dhcpd服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip" class="md-nav__link">
    <span class="md-ellipsis">
      自动管理IP地址
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip_1" class="md-nav__link">
    <span class="md-ellipsis">
      分配固定IP地址
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11postfixdovecot" class="md-nav__link">
    <span class="md-ellipsis">
      11.使用Postfix与Dovecot部署邮件系统
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11.使用Postfix与Dovecot部署邮件系统">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      电子邮件系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      部署基础的电子邮件系统
    </span>
  </a>
  
    <nav class="md-nav" aria-label="部署基础的电子邮件系统">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#postfix" class="md-nav__link">
    <span class="md-ellipsis">
      配置Postfix服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dovecot" class="md-nav__link">
    <span class="md-ellipsis">
      配置Dovecot服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      客户使用电子邮件新系统
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      设置用户别名邮箱
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12iscsi" class="md-nav__link">
    <span class="md-ellipsis">
      12.使用ISCSI服务部署网络存储
    </span>
  </a>
  
    <nav class="md-nav" aria-label="12.使用ISCSI服务部署网络存储">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      无人值守安装系统
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../keepalived/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高可用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%B8%89%E5%89%91%E5%AE%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux三剑客
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MYSQL%2Bkeepalived%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%8F%AF%E7%94%A8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mysql高可用配置
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NGINX/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nginx相关配置
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ME/me/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    关于我
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1.系统安装
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.系统安装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux系统相关
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      软件部署安装
    </span>
  </a>
  
    <nav class="md-nav" aria-label="软件部署安装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux_1" class="md-nav__link">
    <span class="md-ellipsis">
      Linux下软件安装的几种方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdk" class="md-nav__link">
    <span class="md-ellipsis">
      安装jdk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql" class="md-nav__link">
    <span class="md-ellipsis">
      安装mysql
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tomcat" class="md-nav__link">
    <span class="md-ellipsis">
      安装tomcat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="安装tomcat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tomcat_1" class="md-nav__link">
    <span class="md-ellipsis">
      源码安装tomcat
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2linux" class="md-nav__link">
    <span class="md-ellipsis">
      2.Linux系统调优
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.Linux系统调优">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selinux" class="md-nav__link">
    <span class="md-ellipsis">
      关闭selinux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      查看环境变量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      开机自启服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh" class="md-nav__link">
    <span class="md-ellipsis">
      设置ssh服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      设置命令行历史记录数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      锁定重要文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      隐藏系统版本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      通配符
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#top" class="md-nav__link">
    <span class="md-ellipsis">
      top
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      重要的环境变量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      网卡配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      软硬链接
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3raidlvm" class="md-nav__link">
    <span class="md-ellipsis">
      3.raid磁盘阵列与lvm逻辑卷管理
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.raid磁盘阵列与lvm逻辑卷管理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#raid" class="md-nav__link">
    <span class="md-ellipsis">
      raid
    </span>
  </a>
  
    <nav class="md-nav" aria-label="raid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      部署磁盘阵列
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      损坏磁盘阵列及修复
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raid_1" class="md-nav__link">
    <span class="md-ellipsis">
      解除raid
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lvm" class="md-nav__link">
    <span class="md-ellipsis">
      LVM逻辑卷管理器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LVM逻辑卷管理器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      部署逻辑卷
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      扩容逻辑卷
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      缩小逻辑卷
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      逻辑卷快照
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      删除逻辑卷
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4iptablesfirewalld" class="md-nav__link">
    <span class="md-ellipsis">
      4.iptables和firewalld防火墙
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.iptables和firewalld防火墙">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#iptables" class="md-nav__link">
    <span class="md-ellipsis">
      iptables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#firewalld" class="md-nav__link">
    <span class="md-ellipsis">
      firewalld
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      图形管理工具
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      服务的访问控制列表
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cockpit" class="md-nav__link">
    <span class="md-ellipsis">
      Cockpit驾驶舱管理工具
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5ssh" class="md-nav__link">
    <span class="md-ellipsis">
      5.使用ssh服务管理远程主机
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.使用ssh服务管理远程主机">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      配置网卡服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      远程控制服务
    </span>
  </a>
  
    <nav class="md-nav" aria-label="远程控制服务">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      安全密钥验证
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      不间断会话服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      检索日志信息
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6apache" class="md-nav__link">
    <span class="md-ellipsis">
      6.使用apache服务部署静态网站
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.使用apache服务部署静态网站">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      网站服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      配置服务文件参数
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selinux_1" class="md-nav__link">
    <span class="md-ellipsis">
      SELinux安全子系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      虚拟网站主机
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache" class="md-nav__link">
    <span class="md-ellipsis">
      apache的访问控制
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7vsftpd" class="md-nav__link">
    <span class="md-ellipsis">
      7.使用vsftpd服务传输文件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7.使用vsftpd服务传输文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      文件传输协议
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vsftpd" class="md-nav__link">
    <span class="md-ellipsis">
      vsftpd服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tftp" class="md-nav__link">
    <span class="md-ellipsis">
      TFTP简单文件传输协议
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8sambanfs" class="md-nav__link">
    <span class="md-ellipsis">
      8.使用samba/NFS实现文件共享
    </span>
  </a>
  
    <nav class="md-nav" aria-label="8.使用samba/NFS实现文件共享">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#samba" class="md-nav__link">
    <span class="md-ellipsis">
      samba文件共享服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nfs" class="md-nav__link">
    <span class="md-ellipsis">
      NFS网络文件系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autofs" class="md-nav__link">
    <span class="md-ellipsis">
      autofs自动挂载
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9bind" class="md-nav__link">
    <span class="md-ellipsis">
      9.使用bind提供域名解析服务
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9.使用bind提供域名解析服务">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      DNS域名解析服务
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bind" class="md-nav__link">
    <span class="md-ellipsis">
      安装Bind服务程序
    </span>
  </a>
  
    <nav class="md-nav" aria-label="安装Bind服务程序">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-ip" class="md-nav__link">
    <span class="md-ellipsis">
      正向解析（域名-&gt;IP）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip-" class="md-nav__link">
    <span class="md-ellipsis">
      反向解析（IP-&gt;域名）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      部署从服务器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      安全的加密传输
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      部署缓存服务器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10dhcp" class="md-nav__link">
    <span class="md-ellipsis">
      10.使用DHCP动态管理主机地址
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.使用DHCP动态管理主机地址">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhcpd" class="md-nav__link">
    <span class="md-ellipsis">
      部署dhcpd服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip" class="md-nav__link">
    <span class="md-ellipsis">
      自动管理IP地址
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ip_1" class="md-nav__link">
    <span class="md-ellipsis">
      分配固定IP地址
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11postfixdovecot" class="md-nav__link">
    <span class="md-ellipsis">
      11.使用Postfix与Dovecot部署邮件系统
    </span>
  </a>
  
    <nav class="md-nav" aria-label="11.使用Postfix与Dovecot部署邮件系统">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      电子邮件系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      部署基础的电子邮件系统
    </span>
  </a>
  
    <nav class="md-nav" aria-label="部署基础的电子邮件系统">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#postfix" class="md-nav__link">
    <span class="md-ellipsis">
      配置Postfix服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dovecot" class="md-nav__link">
    <span class="md-ellipsis">
      配置Dovecot服务程序
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      客户使用电子邮件新系统
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      设置用户别名邮箱
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12iscsi" class="md-nav__link">
    <span class="md-ellipsis">
      12.使用ISCSI服务部署网络存储
    </span>
  </a>
  
    <nav class="md-nav" aria-label="12.使用ISCSI服务部署网络存储">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      无人值守安装系统
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Yaominan/Yaominan.github.io/edit/main/docs/Linux/linux.md" title="编辑此页" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


  <h1>linux相关</h1>

<h2 id="1">1.系统安装<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<div class="language-text highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1">centos光盘选择
</span><span id="__span-0-2">
</span><span id="__span-0-3">https://mirrors.aliyun.com/centos-vault/7.6.1810/isos/x86_64/?spm=a2c6h.25603864.0.0.484d289bf1kM8o
</span><span id="__span-0-4">
</span><span id="__span-0-5">选择 CentOS-7-x86_64-DVD-1810.iso
</span><span id="__span-0-6">install（参考网站：https://www.cnblogs.com/mr-xiong/p/12470034.html）
</span></code></pre></div></td></tr></table></div>
<p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1">分区配置
</span><span id="__span-1-2">
</span><span id="__span-1-3">boot分区一般是<span class="w"> </span>200M
</span><span id="__span-1-4">swap分区<span class="w"> </span>一般是内存的两倍（16G）
</span><span id="__span-1-5">/分区
</span><span id="__span-1-6">网络配置<span class="o">(</span>NAT模式<span class="o">)</span>
</span><span id="__span-1-7">
</span><span id="__span-1-8">nmcli<span class="w"> </span>connection<span class="w"> </span>modify<span class="w"> </span>ens33<span class="w"> </span>ipv4.methord<span class="w"> </span>manual<span class="w"> </span>ipv4.address<span class="w"> </span><span class="o">[]</span><span class="w"> </span>ipv4.dns<span class="w"> </span><span class="o">[]</span><span class="w"> </span>ipv4.gateway<span class="w"> </span><span class="o">[]</span><span class="w"> </span>autoconnect<span class="w"> </span>yes
</span><span id="__span-1-9">
</span><span id="__span-1-10">ip<span class="w"> </span>a<span class="w"> </span>s
</span></code></pre></div></td></tr></table></div>
解决物理机ping不通虚拟机</p>
<p>物理机上修改虚拟网卡地址</p>
<p>ip和虚拟交换机机的IP在同一网段，网关和虚拟交换机的网关一样，如图nat</p>
<p>解决虚拟机ping不通网关</p>
<p>重置虚拟机网卡（删除添加）</p>
<h3 id="linux">Linux系统相关<a class="headerlink" href="#linux" title="Permanent link">&para;</a></h3>
<p>https://www.linuxcool.com/ （Linux命令大全）</p>
<p>查看系统版本号
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># cat /etc/centos-release</span>
</span></code></pre></div></td></tr></table></div>
查看内核参数
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># uname -a</span>
</span></code></pre></div></td></tr></table></div>
查看端口占用</p>
<p>netstate -luntp | grep ...
处理boot分区满了的办法
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><span class="o">[</span>root@localhost<span class="w"> </span>boot<span class="o">]</span><span class="c1"># uname -r</span>
</span><span id="__span-4-2"><span class="o">[</span>root@localhost<span class="w"> </span>boot<span class="o">]</span><span class="c1"># rpm -qa | grep kernel</span>
</span><span id="__span-4-3">
</span><span id="__span-4-4">
</span><span id="__span-4-5"><span class="o">[</span>root@localhost<span class="w"> </span>boot<span class="o">]</span><span class="c1"># rpm -q kernel</span>
</span><span id="__span-4-6">
</span><span id="__span-4-7">
</span><span id="__span-4-8"><span class="o">[</span>root@localhost<span class="w"> </span>boot<span class="o">]</span><span class="c1"># rpm -e kernel-3.10.0-957.el7.x86_64   （删除较老的版本）</span>
</span><span id="__span-4-9">
</span><span id="__span-4-10">
</span><span id="__span-4-11"><span class="o">[</span>root@localhost<span class="w"> </span>boot<span class="o">]</span><span class="c1"># df  -lh</span>
</span></code></pre></div></td></tr></table></div></p>
<h3 id="_1">软件部署安装<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<h4 id="linux_1">Linux下软件安装的几种方式<a class="headerlink" href="#linux_1" title="Permanent link">&para;</a></h4>
<p>Linux下常见的安装包有以下集中形式（名称-版本-修正版-类型）：</p>
<p>tar包：如software-1.2.3-1.tar.gz 该形式是用打包工具tar打包的
rpm包：如software-1.2.3-1.i386.rpm 这是Redhat Linux提供的一种报道额封装格式
dpkg包：如software-1.2.3-1.deb 这是Debian提供的包的封装格式
源码安装</p>
<p>rpm安装</p>
<p>yum安装</p>
<p>配置软件仓库
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><span class="o">[</span>root@192<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># wget -O /etc/yum.repos.d/CentOS-Base.repo   https://mirrors.aliyun.com/repo/Centos-7.repo</span>
</span><span id="__span-5-2"><span class="o">[</span>root@192<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># yum clean all</span>
</span><span id="__span-5-3">
</span><span id="__span-5-4">
</span><span id="__span-5-5"><span class="o">[</span>root@192<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># yum makecache</span>
</span></code></pre></div></td></tr></table></div></p>
<h4 id="jdk">安装jdk<a class="headerlink" href="#jdk" title="Permanent link">&para;</a></h4>
<p>下载jdk压缩包</p>
<p>解压
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1">tar<span class="w"> </span>-xzvf<span class="w"> </span>jdk-18_linux-x64_bin.tar.gz
</span><span id="__span-6-2">mv<span class="w"> </span>jdk-18.0.2<span class="w"> </span>/usr/local/tools/
</span></code></pre></div></td></tr></table></div>
卸载openjdk</p>
<p>yum remove ***</p>
<p>修改配置/etc/profile
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><span class="nb">export</span><span class="w"> </span><span class="nv">JAVA_HOME</span><span class="o">=</span>/usr/local/tools/jdk-18.0.2<span class="w"> </span>（jdk的存放路径）​<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">CLASSPATH</span><span class="o">=</span>.:<span class="nv">$JAVA_HOME</span>/lib/dt.jar:<span class="nv">$JAVA_HOME</span>/lib/tools.jar​<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$JAVA_HOME</span>/bin
</span><span id="__span-7-2">
</span><span id="__span-7-3"><span class="nb">source</span><span class="w"> </span>/etc/profile
</span><span id="__span-7-4">
</span><span id="__span-7-5">Java<span class="w"> </span>-version
</span></code></pre></div></td></tr></table></div></p>
<h4 id="mysql">安装mysql<a class="headerlink" href="#mysql" title="Permanent link">&para;</a></h4>
<p>下载mysql
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1">mysql-8.0.30-1.el7.x86_64.rpm-bundle.tar
</span><span id="__span-8-2"><span class="c1">#删除自带的mariadb</span>
</span><span id="__span-8-3"><span class="o">[</span>root@localhost<span class="w"> </span>opt<span class="o">]</span><span class="c1"># rpm -qa | grep mariadb</span>
</span><span id="__span-8-4"><span class="o">[</span>root@localhost<span class="w"> </span>opt<span class="o">]</span><span class="c1"># yum list | grep mariadb*</span>
</span><span id="__span-8-5"><span class="o">[</span>root@localhost<span class="w"> </span>opt<span class="o">]</span><span class="c1"># yum remove mariadb-libs.x86_64</span>
</span><span id="__span-8-6"><span class="c1"># 解压</span>
</span><span id="__span-8-7">
</span><span id="__span-8-8"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># tar -xvf mysql-8.0.30-1.el7.x86_64.rpm-bundle.tar</span>
</span><span id="__span-8-9"><span class="c1">#安装（需要按照顺序）</span>
</span><span id="__span-8-10">
</span><span id="__span-8-11"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># rpm -ivh mysql-community-common-8.0.30-1.el7.x86_64.rpm -c --nodeps --force</span>
</span><span id="__span-8-12"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># rpm -ivh mysql-community-libs-8.0.30-1.el7.x86_64.rpm -c --nodeps --force</span>
</span><span id="__span-8-13"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># rpm -ivh mysql-community-client-8.0.30-1.el7.x86_64.rpm -c --nodeps --force</span>
</span><span id="__span-8-14"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># rpm -ivh mysql-community-server-8.0.30-1.el7.x86_64.rpm -c --nodeps --force</span>
</span><span id="__span-8-15"><span class="c1">#检查</span>
</span><span id="__span-8-16"><span class="o">[</span>localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># rpm -qa | grep mysql</span>
</span><span id="__span-8-17"><span class="c1">#初始化mysql</span>
</span><span id="__span-8-18">
</span><span id="__span-8-19"><span class="c1">#初始化</span>
</span><span id="__span-8-20">
</span><span id="__span-8-21"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># mysqld --initialize</span>
</span><span id="__span-8-22">
</span><span id="__span-8-23"><span class="c1">#生成初始密码</span>
</span><span id="__span-8-24">
</span><span id="__span-8-25">root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># chown mysql:mysql /var/lib/mysql -R</span>
</span><span id="__span-8-26">
</span><span id="__span-8-27"><span class="c1">#开启服务查看初始密码</span>
</span><span id="__span-8-28">
</span><span id="__span-8-29"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># cat /var/log/mysqld.log | grep password</span>
</span><span id="__span-8-30">
</span><span id="__span-8-31"><span class="c1">#登录mysql</span>
</span><span id="__span-8-32">
</span><span id="__span-8-33"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># mysql -uroot -p [enter输入复制的密码]</span>
</span><span id="__span-8-34">
</span><span id="__span-8-35"><span class="c1">#重置密码（密码永久不过期）</span>
</span><span id="__span-8-36">
</span><span id="__span-8-37">mysql&gt;<span class="w"> </span>alter<span class="w"> </span>user<span class="w"> </span>root@<span class="s1">&#39;localhost&#39;</span><span class="w"> </span>identified<span class="w"> </span>by<span class="w"> </span><span class="s1">&#39;yma666&#39;</span><span class="w"> </span>password<span class="w"> </span>expire<span class="w"> </span>never<span class="p">;</span>
</span><span id="__span-8-38">
</span><span id="__span-8-39"><span class="c1">#开放防火墙端口</span>
</span><span id="__span-8-40">
</span><span id="__span-8-41"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># firewall-cmd --list-all</span>
</span><span id="__span-8-42"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --add-port=3306/tcp --permanent</span>
</span><span id="__span-8-43"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># firewall-cmd --reload</span>
</span><span id="__span-8-44"><span class="c1">#连接数据库</span>
</span><span id="__span-8-45">
</span><span id="__span-8-46"><span class="c1">#创建用户用来外部连接数据库</span>
</span><span id="__span-8-47">
</span><span id="__span-8-48">mysql&gt;<span class="w"> </span>create<span class="w"> </span>user<span class="w"> </span>yma@<span class="s1">&#39;%&#39;</span><span class="w"> </span>identified<span class="w"> </span>by<span class="w"> </span><span class="s1">&#39;yma666&#39;</span><span class="p">;</span>
</span><span id="__span-8-49">
</span><span id="__span-8-50"><span class="c1">#授权</span>
</span><span id="__span-8-51">
</span><span id="__span-8-52">mysql&gt;<span class="w"> </span>grant<span class="w"> </span>all<span class="w"> </span>on<span class="w"> </span>.<span class="w"> </span>to<span class="w"> </span>yma@<span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span><span id="__span-8-53">
</span><span id="__span-8-54"><span class="c1">#其他连接问题解决方案</span>
</span><span id="__span-8-55">
</span><span id="__span-8-56">alter<span class="w"> </span>user<span class="w"> </span><span class="s1">&#39;lzj&#39;</span>@<span class="s1">&#39;%&#39;</span><span class="w"> </span>identified<span class="w"> </span>by<span class="w"> </span><span class="s1">&#39;zdx123zdx&#39;</span><span class="w"> </span>password<span class="w"> </span>expire<span class="w"> </span>never<span class="p">;</span>
</span><span id="__span-8-57">alter<span class="w"> </span>user<span class="w"> </span><span class="s1">&#39;root&#39;</span>@<span class="s1">&#39;localhost&#39;</span><span class="w"> </span>identified<span class="w"> </span>with<span class="w"> </span>mysql_native_password<span class="w"> </span>by<span class="w"> </span><span class="s1">&#39;password&#39;</span><span class="p">;</span>
</span><span id="__span-8-58">
</span><span id="__span-8-59">
</span><span id="__span-8-60">alter<span class="w"> </span>user<span class="w"> </span><span class="s1">&#39;lzj&#39;</span>@<span class="s1">&#39;%&#39;</span><span class="w"> </span>identified<span class="w"> </span>with<span class="w"> </span>mysql_native_password<span class="w"> </span>by<span class="w"> </span><span class="s1">&#39;zdx123zdx&#39;</span><span class="p">;</span>
</span><span id="__span-8-61">
</span><span id="__span-8-62">
</span><span id="__span-8-63">
</span><span id="__span-8-64">alter<span class="w"> </span>user<span class="w"> </span><span class="s1">&#39;root&#39;</span>@<span class="s1">&#39;localhost&#39;</span><span class="w"> </span>identified<span class="w"> </span>with<span class="w"> </span>mysql_native_password<span class="w"> </span>by<span class="w"> </span><span class="s1">&#39;password&#39;</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div></p>
<h4 id="tomcat">安装tomcat<a class="headerlink" href="#tomcat" title="Permanent link">&para;</a></h4>
<p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><span class="o">[</span>root@localhost<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># yum -y install tomcat</span>
</span><span id="__span-9-2"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># rpm -qa | grep tomcat</span>
</span><span id="__span-9-3"><span class="c1">#启动tomcat</span>
</span><span id="__span-9-4"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># systemctl start tomcat.service</span>
</span><span id="__span-9-5"><span class="c1">#开放防火墙端口</span>
</span><span id="__span-9-6"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --add-port=8080/tcp --permanent</span>
</span><span id="__span-9-7"><span class="c1">#重启或重新加载（--reload）防火墙</span>
</span><span id="__span-9-8"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># systemctl restart firewalld.service</span>
</span><span id="__span-9-9"><span class="c1">#安装网页插件</span>
</span><span id="__span-9-10"><span class="o">[</span>root@localhost<span class="w"> </span>mysql<span class="o">]</span><span class="c1"># yum -y install tomcat-admin-webapps.noarch tomcat-webapps.noarch</span>
</span><span id="__span-9-11"><span class="c1">#修改文件/etc/tomcat/tomcat-users.xml</span>
</span><span id="__span-9-12">
</span><span id="__span-9-13"><span class="m">8</span>.<span class="w"> </span>登录管理所有发布的应用
</span><span id="__span-9-14">http://192.168.10.11:8080/manager/html
</span><span id="__span-9-15">
</span><span id="__span-9-16">
</span><span id="__span-9-17">
</span><span id="__span-9-18">
</span><span id="__span-9-19">选择war包发布
</span><span id="__span-9-20">
</span><span id="__span-9-21">
</span><span id="__span-9-22">image-20220808184124941
</span><span id="__span-9-23">
</span><span id="__span-9-24">
</span><span id="__span-9-25">
</span><span id="__span-9-26">
</span><span id="__span-9-27">配置SSL
</span><span id="__span-9-28">
</span><span id="__span-9-29">
</span><span id="__span-9-30">
</span><span id="__span-9-31">
</span><span id="__span-9-32">
</span><span id="__span-9-33"><span class="nb">cd</span><span class="w"> </span>/usr/java/jdk1.6.0_32/bin
</span><span id="__span-9-34">./keytool<span class="w"> </span>-genkey<span class="w"> </span>-alias<span class="w"> </span>tomcat<span class="w"> </span>-keyalg<span class="w"> </span>RSA<span class="w"> </span>-keystore<span class="w"> </span>/usr/local/tomcat/conf/.keystore
</span></code></pre></div></td></tr></table></div>
参考：https://www.jb51.net/LINUXjishu/801011.html</p>
<h5 id="tomcat_1">源码安装tomcat<a class="headerlink" href="#tomcat_1" title="Permanent link">&para;</a></h5>
<p>下载apache-tomcat-9.0.65.tar.gz</p>
<p>上传到服务器</p>
<p>将文件解压到安装位置（/usr/local/tools/tomcat）
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><span class="o">[</span>root@localhost<span class="w"> </span>bin<span class="o">]</span><span class="c1"># cp -p /usr/local/tools/tomcat/bin/catalina.sh /etc/init.d/tomcat</span>
</span></code></pre></div></td></tr></table></div>
设置开机自启</p>
<p>参考：https://blog.csdn.net/cbuy888/article/details/87190065</p>
<p>[root@localhost bin]# vim /etc/init.d/tomcat
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><span class="c1"># chkconfig: 112（启动级别0-6） 63（启动优先级0-100） 37（停止优先级0-100，数字越大，优先级越低）</span>
</span><span id="__span-11-2"><span class="c1"># description: tomcat server init script</span>
</span><span id="__span-11-3"><span class="c1"># Source Function Library</span>
</span><span id="__span-11-4">.<span class="w"> </span>/etc/init.d/functions
</span><span id="__span-11-5"><span class="nv">JAVA_HOME</span><span class="o">=</span>/usr/local/tools/jdk-18.0.2
</span><span id="__span-11-6"><span class="nv">CATALINA_HOME</span><span class="o">=</span>/usr/local/tools/tomcat
</span><span id="__span-11-7"><span class="o">[</span>root@localhost<span class="w"> </span>bin<span class="o">]</span><span class="c1"># chmod 755 /etc/init.d/tomcat</span>
</span><span id="__span-11-8"><span class="o">[</span>root@localhost<span class="w"> </span>bin<span class="o">]</span><span class="c1"># chkconfig --add tomcat</span>
</span><span id="__span-11-9"><span class="o">[</span>root@localhost<span class="w"> </span>bin<span class="o">]</span><span class="c1"># chkconfig tomcat on</span>
</span></code></pre></div></td></tr></table></div>
配置tomcat</p>
<p>修改端口（如下代码块）
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><span class="o">[</span>root@localhost<span class="w"> </span>conf<span class="o">]</span><span class="c1"># vim /usr/local/tools/tomcat/conf/server.xml</span>
</span><span id="__span-12-2"><span class="w">    </span>&lt;Connector<span class="w"> </span><span class="nv">port</span><span class="o">=</span><span class="s2">&quot;80&quot;</span><span class="w"> </span><span class="nv">protocol</span><span class="o">=</span><span class="s2">&quot;HTTP/1.1&quot;</span>
</span><span id="__span-12-3"><span class="w">               </span><span class="nv">connectionTimeout</span><span class="o">=</span><span class="s2">&quot;20000&quot;</span>
</span><span id="__span-12-4"><span class="w">               </span><span class="nv">redirectPort</span><span class="o">=</span><span class="s2">&quot;8443&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-12-5"><span class="o">[</span>root@localhost<span class="w"> </span>conf<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --add-port=80/tcp --permanent </span>
</span><span id="__span-12-6"><span class="c1">#配置虚拟主机（网站）</span>
</span><span id="__span-12-7">
</span><span id="__span-12-8"><span class="o">[</span>root@localhost<span class="w"> </span>conf<span class="o">]</span><span class="c1"># vim /usr/local/tools/tomcat/conf/server.xml</span>
</span><span id="__span-12-9">&lt;Host<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;www.yma.ca&quot;</span><span class="w">  </span><span class="nv">appBase</span><span class="o">=</span><span class="s2">&quot;webapps&quot;</span>
</span><span id="__span-12-10"><span class="w">         </span><span class="nv">unpackWARs</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="w"> </span><span class="nv">autoDeploy</span><span class="o">=</span><span class="s2">&quot;true&quot;</span>&gt;
</span><span id="__span-12-11"><span class="w">         </span>&lt;!--<span class="w"> </span>SingleSignOn<span class="w"> </span>valve,<span class="w"> </span>share<span class="w"> </span>authentication<span class="w"> </span>between<span class="w"> </span>web<span class="w"> </span>applications
</span><span id="__span-12-12"><span class="w">      </span>Documentation<span class="w"> </span>at:<span class="w"> </span>/docs/config/valve.html<span class="w"> </span>--&gt;
</span><span id="__span-12-13"><span class="w"> </span>&lt;!--
</span><span id="__span-12-14"><span class="w"> </span>&lt;Valve<span class="w"> </span><span class="nv">className</span><span class="o">=</span><span class="s2">&quot;org.apache.catalina.authenticator.SingleSignOn&quot;</span><span class="w"> </span>/&gt;
</span><span id="__span-12-15"><span class="w"> </span>--&gt;
</span><span id="__span-12-16">a
</span><span id="__span-12-17">
</span><span id="__span-12-18"><span class="c1">#配置SSL</span>
</span><span id="__span-12-19">
</span><span id="__span-12-20"><span class="o">[</span>root@localhost<span class="w"> </span>conf<span class="o">]</span><span class="c1"># cd /usr/local/tools/jdk-18.0.2/bin</span>
</span><span id="__span-12-21"><span class="o">[</span>root@localhost<span class="w"> </span>bin<span class="o">]</span><span class="c1"># ./keytool -genkey -alias tomcat -keyalg RSA -keystore /usr/local/tools/tomcat/conf/.keystore</span>
</span></code></pre></div></td></tr></table></div></p>
<h2 id="2linux">2.Linux系统调优<a class="headerlink" href="#2linux" title="Permanent link">&para;</a></h2>
<h3 id="selinux">关闭selinux<a class="headerlink" href="#selinux" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1">vim<span class="w"> </span>/etc/selinux/config
</span></code></pre></div></td></tr></table></div>
<h3 id="_2">查看环境变量<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1">env
</span><span id="__span-14-2">
</span><span id="__span-14-3">env<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>JAVA
</span><span id="__span-14-4">设置环境变量文件/etc/profile
</span><span id="__span-14-5">
</span><span id="__span-14-6">设置账户超时时间
</span><span id="__span-14-7">
</span><span id="__span-14-8"><span class="o">[</span>root@chao<span class="w"> </span>~<span class="o">]</span><span class="c1"># echo &#39;export TMOUT=300&#39; &gt;&gt;/etc/profile</span>
</span><span id="__span-14-9"><span class="o">[</span>root@chao<span class="w"> </span>~<span class="o">]</span><span class="c1"># source /etc/profile</span>
</span><span id="__span-14-10"><span class="o">[</span>root@chao<span class="w"> </span>~<span class="o">]</span><span class="c1"># env |grep -i tmout</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="_3">开机自启服务<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<ul>
<li>需要开机自启的服务</li>
<li>sshd,远程连接需要使用此服务</li>
<li>rsyslog,日志有关的软件</li>
<li>networ，网络相关的软件</li>
<li>crond,定时任务相关软件</li>
<li>sysstat数据分析的软件</li>
<li>查看目前开机自启的服务
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1">systemctl<span class="w"> </span>list-unit-files<span class="p">|</span>grep<span class="w"> </span>enabled
</span></code></pre></div></td></tr></table></div></li>
<li>关闭开机自启
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1">systemctl<span class="w"> </span>disable<span class="w"> </span>postfix.service<span class="w"> </span>
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="ssh">设置ssh服务<a class="headerlink" href="#ssh" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><span class="c1">#编辑/etc/ssh/sshd_config</span>
</span><span id="__span-17-2">
</span><span id="__span-17-3"><span class="c1">#Port 22222 （默认端口22）</span>
</span><span id="__span-17-4">Linux中文设置
</span><span id="__span-17-5">查看系统是否是<span class="w"> </span>zh_CN.UTF-8，添加代码
</span><span id="__span-17-6">
</span><span id="__span-17-7">cat<span class="w"> </span>/etc/locale.conf
</span><span id="__span-17-8">
</span><span id="__span-17-9"><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="_4">设置命令行历史记录数<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><span class="o">[</span>root@chao<span class="w"> </span>~<span class="o">]</span><span class="c1"># sed -i &#39;s/^HISTSIZE=5/HISTSIZE=10/&#39; /etc/profile</span>
</span><span id="__span-18-2"><span class="o">[</span>root@chao<span class="w"> </span>~<span class="o">]</span><span class="c1"># source /etc/profile</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="_5">锁定重要文件<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><span class="o">[</span>root@chao<span class="w"> </span>~<span class="o">]</span><span class="c1"># chattr -i /etc/passwd /etc/shoadow /etc/group /etc/gshadow /etc/inittab</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="_6">隐藏系统版本<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><span class="o">[</span>root@chao<span class="w"> </span>~<span class="o">]</span><span class="c1"># echo redflag 5.9 &gt;/etc/issue</span>
</span><span id="__span-20-2"><span class="o">[</span>root@chao<span class="w"> </span>~<span class="o">]</span><span class="c1"># cat /etc/issue</span>
</span><span id="__span-20-3">redflag<span class="w"> </span><span class="m">5</span>.9
</span></code></pre></div></td></tr></table></div>
<h3 id="_7">通配符<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>表3-3 Linux系统中的通配符及含义</p>
<table>
<thead>
<tr>
<th>通配符</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>任意字符</td>
</tr>
<tr>
<td>?</td>
<td>单个任意字符</td>
</tr>
<tr>
<td>[a-z]</td>
<td>单个小写字母</td>
</tr>
<tr>
<td>[A-Z]</td>
<td>单个大写字母</td>
</tr>
<tr>
<td>[a-Z]</td>
<td>单个字母</td>
</tr>
<tr>
<td>[0-9]</td>
<td>单个数字</td>
</tr>
<tr>
<td>[[:alpha:]]</td>
<td>任意字母</td>
</tr>
<tr>
<td>[[:upper:]]</td>
<td>任意大写字母</td>
</tr>
<tr>
<td>[[:lower:]]</td>
<td>任意小写字母</td>
</tr>
<tr>
<td>[[:digit:]]</td>
<td>所有数字</td>
</tr>
<tr>
<td>[[:alnum:]]</td>
<td>任意字母加数字</td>
</tr>
<tr>
<td>[[:punct:]]</td>
<td>标点符号</td>
</tr>
<tr>
<td>转义符</td>
<td></td>
</tr>
<tr>
<td>反斜杠（\）：使反斜杠后面的一个变量变为单纯的字符。</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>单引号（' '）：转义其中所有的变量为单纯的字符串。</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>双引号（" "）：保留其中的变量属性，不进行转义处理。</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>反引号（）：把其中的命令执行后返回结果。</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="top">top<a class="headerlink" href="#top" title="Permanent link">&para;</a></h3>
<p>top -p ：查看指定进程的top信息
top -H -p:查看指定进程的所有线程的top信息</p>
<h3 id="_8">重要的环境变量<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>表3-4 Linux系统中最重要的10个环境变量</p>
<p>变量名称    作用
HOME    用户的主目录（即家目录）
SHELL   用户在使用的Shell解释器名称
HISTSIZE    输出的历史命令记录条数
HISTFILESIZE    保存的历史命令记录条数
MAIL    邮件保存路径
LANG    系统语言、语系名称
RANDOM  生成一个随机数字
PS1 Bash解释器的提示符
PATH    定义解释器搜索用户执行命令的路径
EDITOR  用户默认的文本编辑器</p>
<h3 id="_9">网卡配置<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>设备类型：TYPE=Ethernet</p>
<p>地址分配模式：BOOTPROTO=static</p>
<p>网卡名称：NAME=ens160</p>
<p>是否启动：ONBOOT=yes</p>
<p>IP地址：IPADDR=192.168.10.10</p>
<p>子网掩码：NETMASK=255.255.255.0</p>
<p>网关地址：GATEWAY=192.168.10.1</p>
<p>DNS地址：DNS1=192.168.10.1</p>
<p>按照测试对象来划分，条件测试语句可以分为4种：
文件测试语句；</p>
<p>逻辑测试语句；</p>
<p>整数值比较语句；</p>
<p>字符串比较语句。</p>
<p>表4-3 文件测试所用的参数</p>
<p>操作符 作用
-d  测试文件是否为目录类型
-e  测试文件是否存在
-f  判断是否为一般文件
-r  测试当前用户是否有权限读取
-w  测试当前用户是否有权限写入
-x  测试当前用户是否有权限执行
表4-4 可用的整数比较运算符</p>
<p>操作符 作用
-eq 是否等于
-ne 是否不等于
-gt 是否大于
-lt 是否小于
-le 是否等于或小于
-ge 是否大于或等于
表4-5 常见的字符串比较运算符</p>
<p>操作符 作用
=   比较字符串内容是否相同
!=  比较字符串内容是否不同
-z  判断字符串内容是否为空
表5-7 SUID、SGID、SBIT特殊权限的设置参数</p>
<p>参数  作用
u+s 设置SUID权限
u-s 取消SUID权限
g+s 设置SGID权限
g-s 取消SGID权限
o+t 设置SBIT权限
o-t 取消SBIT权限
表5-8 chattr/lsattr命令中的参数及其作用</p>
<p>参数  作用
i   无法对文件进行修改；若对目录设置了该参数，则仅能修改其中的子文件内容而不能新建或删除文件
a   仅允许补充（追加）内容，无法覆盖/删除内容（Append Only）
S   文件内容在变更后立即同步到硬盘（sync）
s   彻底从硬盘中删除，不可恢复（用0填充原文件所在硬盘区域）
A   不再修改这个文件或目录的最后访问时间（atime）
b   不再修改文件或目录的存取时间
D   检查压缩文件中的错误
d   使用dump命令备份时忽略本文件/目录
c   默认将文件或目录进行压缩
u   当删除该文件后依然保留其在硬盘中的数据，方便日后恢复
t   让文件系统支持尾部合并（tail-merging）
x   可以直接访问压缩文件中的内容
partprobe 重读分区表</p>
<p>uquota 磁盘容量配额</p>
<p>xfs_quota管理设备的磁盘容量配额</p>
<p>xfs_quota -x -c 'limit bsoft=3M bhard=6M isoft=3 ihard=6 tom' /boot
edquota管理系统的磁盘配额</p>
<p>表6-6 edquota命令中可用的参数以及作用</p>
<p>参数  作用
-u  对某个用户进行设置
-g  对某个用户组进行设置
-p  复制原有的规则到新的用户/组
-t  限制宽限期限</p>
<h3 id="_10">软硬链接<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>表6-8 ln命令中可用的参数以及作用</p>
<p>参数  作用
-s  创建“符号链接”（如果不带-s参数，则默认创建硬链接）
-f  强制创建文件或目录的链接
-i  覆盖前先询问
-v  显示创建链接的过程</p>
<h2 id="3raidlvm">3.raid磁盘阵列与lvm逻辑卷管理<a class="headerlink" href="#3raidlvm" title="Permanent link">&para;</a></h2>
<h3 id="raid">raid<a class="headerlink" href="#raid" title="Permanent link">&para;</a></h3>
<p>表7-3 RAID 0、1、5、10方案技术对比</p>
<p>RAID级别  最少硬盘    可用容量    读写性能    安全性 特点
0   2   n   n   低   追求最大容量和速度，任何一块盘损坏，数据全部异常。
1   2   n/2 n   高   追求最大安全性，只要阵列组中有一块硬盘可用，数据不受影响。
5   3   n-1 n-1 中   在控制成本的前提下，追求硬盘的最大容量、速度及安全性，允许有一块硬盘异常，数据不受影响。
10  4   n/2 n/2 高   综合RAID1和RAID0的优点，追求硬盘的速度和安全性，允许有一半硬盘异常（不可同组），数据不受影响
raid0</p>
<p>将至少两块的物理设备通过硬件或软件的方式串联到一起，将数据依次写入到各个物理硬盘中，容量大，读写快，安全性低
raid1</p>
<p>将两块以上的硬盘进行绑定，在写入数据的时候，同时写入到多块硬盘设备上（类似于镜像/备份），当一块硬盘发生故障，一般会以自动热交换的方式回复数据的使用。空间使用率低，数据安全性高，读写速度较raid0稍低
raid5</p>
<p>raid5是把硬盘设备的数据的奇偶校验信息保存到其他每一块硬盘上，而不是备份真实的数据信息，当发生故障时，通过奇偶校验信息尝试重建损坏的数据，兼顾速度、安全、成本。
RAID 5最少由3块硬盘组成，使用的是硬盘切割（Disk Striping）技术。相较于RAID 1级别，好处就在于保存的是奇偶校验信息而不是一模一样的文件内容，所以当重复写入某个文件时，RAID 5级别的磁盘阵列组只需要对应一个奇偶校验信息就可以，效率更高，存储成本也会随之降低。
raid10</p>
<p>结合了raid0 和raid1的技术，最少需要4块硬盘，先两两组成raid1阵列，然后利用raid0技术将两个阵列组合成raid0阵列</p>
<h4 id="_11">部署磁盘阵列<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<p>表7-2 mdadm命令的常用参数和作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-a</td>
<td>检测设备名称</td>
</tr>
<tr>
<td>-n</td>
<td>指定设备数量</td>
</tr>
<tr>
<td>-l</td>
<td>指定RAID级别</td>
</tr>
<tr>
<td>-C</td>
<td>创建</td>
</tr>
<tr>
<td>-v</td>
<td>显示过程</td>
</tr>
<tr>
<td>-f</td>
<td>模拟设备损坏</td>
</tr>
<tr>
<td>-r</td>
<td>移除设备</td>
</tr>
<tr>
<td>-Q</td>
<td>查看摘要信息</td>
</tr>
<tr>
<td>-D</td>
<td>查看详细信息</td>
</tr>
<tr>
<td>-S</td>
<td>停止RAID磁盘阵列</td>
</tr>
<tr>
<td>-x</td>
<td>备份盘</td>
</tr>
</tbody>
</table>
<ul>
<li>部署raid10
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1">mdadm<span class="w"> </span>-Cv<span class="w"> </span>/dev/md0<span class="w"> </span>-n<span class="w"> </span><span class="m">4</span><span class="w"> </span>-l<span class="w"> </span><span class="m">10</span><span class="w"> </span>/dev/sdb<span class="w"> </span>/dev/sdc<span class="w"> </span>/dev/sdd<span class="w"> </span>/dev/sde
</span><span id="__span-21-2">mdadm<span class="w"> </span>-Q<span class="w"> </span>/dev/md0
</span><span id="__span-21-3">mdadm<span class="w"> </span>-D<span class="w"> </span>/dev/md0
</span><span id="__span-21-4">mkfs.ext4<span class="w"> </span>/dev/md0
</span><span id="__span-21-5">mdadm<span class="w"> </span>--detail<span class="w"> </span>--scan<span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/mdadm.conf
</span><span id="__span-21-6">mkdir<span class="w"> </span>/RAID
</span><span id="__span-21-7"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;/dev/md0 /RAID ext4 defaults 0 0&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/fstab
</span><span id="__span-21-8">mount<span class="w"> </span>-a
</span></code></pre></div></td></tr></table></div></li>
<li>部署raid5
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1">mdadm<span class="w"> </span>-Cv<span class="w"> </span>/dev/md0<span class="w"> </span>-n<span class="w"> </span><span class="m">3</span><span class="w"> </span>-l<span class="w"> </span><span class="m">5</span><span class="w"> </span>-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>/dev/sdb<span class="w"> </span>/dev/sdc<span class="w"> </span>/dev/sdd<span class="w"> </span>/dev/sde
</span><span id="__span-22-2">mdadm<span class="w"> </span>-D<span class="w"> </span>/dev/md0
</span><span id="__span-22-3">mkfs.ext4<span class="w"> </span>/dev/md0
</span><span id="__span-22-4">mount<span class="w"> </span>/dev/md0<span class="w"> </span>/RAID
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="_12">损坏磁盘阵列及修复<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<p>*重启后遇到进入emergency mode，进fstab把无效的挂载删掉
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1">mdadm<span class="w"> </span>/dev/md0<span class="w"> </span>-f<span class="w"> </span>/dev/sdd<span class="w"> </span><span class="o">(</span>模拟硬盘<span class="o">)</span>
</span><span id="__span-23-2">mdadm<span class="w"> </span>/dev/md0<span class="w"> </span>-r<span class="w"> </span>/dev/sdd<span class="w"> </span><span class="o">(</span>移除硬盘<span class="o">)</span>
</span><span id="__span-23-3">umount<span class="w"> </span>/RAID
</span><span id="__span-23-4">mdadm<span class="w"> </span>/dev/md0<span class="w"> </span>-a<span class="w"> </span>/dev/sdf
</span><span id="__span-23-5">mdadm<span class="w"> </span>-D<span class="w"> </span>/dev/md0
</span></code></pre></div></td></tr></table></div></p>
<h4 id="raid_1">解除raid<a class="headerlink" href="#raid_1" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1">umount<span class="w"> </span>/RAID
</span><span id="__span-24-2">mdadm<span class="w"> </span>/dev/md0<span class="w"> </span>-r<span class="w"> </span>/dev/sd<span class="o">[</span>b-e<span class="o">]</span>
</span><span id="__span-24-3">mdadm<span class="w"> </span>-S<span class="w"> </span>/dev/md0
</span><span id="__span-24-4">mdadm<span class="w"> </span>--remove<span class="w"> </span>/dev/md0
</span><span id="__span-24-5">mdadm<span class="w"> </span>--misc<span class="w"> </span>--zero-superblock<span class="w"> </span>/dev/sd<span class="o">[</span>b-e<span class="o">]</span>
</span><span id="__span-24-6">rm<span class="w"> </span>-rf<span class="w"> </span>/etc/mdadm.conf
</span><span id="__span-24-7">删除fstab挂载项
</span></code></pre></div></td></tr></table></div>
<h3 id="lvm">LVM逻辑卷管理器<a class="headerlink" href="#lvm" title="Permanent link">&para;</a></h3>
<h4 id="_13">部署逻辑卷<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<p>表7-3 常用的LVM部署命令</p>
<table>
<thead>
<tr>
<th>功能/命令</th>
<th>物理卷管理</th>
<th>卷组管理</th>
<th>逻辑卷管理</th>
</tr>
</thead>
<tbody>
<tr>
<td>扫描</td>
<td>pvscan vgscan</td>
<td>lvscan</td>
<td></td>
</tr>
<tr>
<td>建立</td>
<td>pvcreate</td>
<td>vgcreate</td>
<td>lvcreate</td>
</tr>
<tr>
<td>显示</td>
<td>pvdisplay</td>
<td>vgdisplay</td>
<td>lvdisplay</td>
</tr>
<tr>
<td>删除</td>
<td>pvremove</td>
<td>vgremove</td>
<td>lvremove</td>
</tr>
<tr>
<td>扩展</td>
<td></td>
<td>vgextend</td>
<td>lvextend</td>
</tr>
<tr>
<td>缩小</td>
<td></td>
<td>vgreduce</td>
<td>lvreduce</td>
</tr>
<tr>
<td><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1">pvcreate<span class="w"> </span>/dev/sdf<span class="w"> </span>/dev/sdg
</span><span id="__span-25-2">vgcreate<span class="w"> </span>storage<span class="w"> </span>/dev/sdf<span class="w"> </span>/dev/sdg
</span><span id="__span-25-3">vgdisplay
</span><span id="__span-25-4">lvcreate<span class="w"> </span>-n<span class="w"> </span>vo<span class="w"> </span>-L<span class="w"> </span>150M<span class="w"> </span>storage
</span><span id="__span-25-5">lvdisplay
</span><span id="__span-25-6">mkfs.ext4<span class="w"> </span>/dev/storage/vo
</span><span id="__span-25-7">mkdir<span class="w"> </span>/gmiao
</span><span id="__span-25-8">mount<span class="w"> </span>/dev/storage/vo<span class="w"> </span>/gmiao/
</span><span id="__span-25-9"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;/dev/storage/vo /gmiao/ ext4 defaults 0 0&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/fstab
</span></code></pre></div></td></tr></table></div></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="_14">扩容逻辑卷<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1">umount<span class="w"> </span>/gmiao
</span><span id="__span-26-2">lvextend<span class="w"> </span>-L<span class="w"> </span>290M<span class="w"> </span>/dev/storage/vo
</span><span id="__span-26-3">e2fsck<span class="w"> </span>-f<span class="w"> </span>/dev/storage/vo
</span><span id="__span-26-4">resize2fs<span class="w"> </span>/dev/storage/vo
</span><span id="__span-26-5">mount<span class="w"> </span>-a
</span><span id="__span-26-6">df<span class="w"> </span>-h
</span></code></pre></div></td></tr></table></div>
<h4 id="_15">缩小逻辑卷<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1">umount<span class="w"> </span>/gmiao
</span><span id="__span-27-2">e2fsck<span class="w"> </span>-f<span class="w"> </span>/dev/storage/vo<span class="w"> </span>（检查文件系统的完整性）
</span><span id="__span-27-3">resize2fs<span class="w"> </span>/dev/storage/vo<span class="w"> </span>120M
</span><span id="__span-27-4">lvreduce<span class="w"> </span>-L<span class="w"> </span>120M<span class="w"> </span>/dev/storage/vo
</span><span id="__span-27-5">mount<span class="w"> </span>-a
</span><span id="__span-27-6">df<span class="w"> </span>-h
</span></code></pre></div></td></tr></table></div>
<h4 id="_16">逻辑卷快照<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1">lvcreate<span class="w"> </span>-L<span class="w"> </span>120M<span class="w"> </span>-s<span class="w"> </span>-n<span class="w"> </span>snap<span class="w"> </span>/dev/storage/vo<span class="w"> </span><span class="o">(</span>-s参数表示创建快照卷<span class="o">)</span>
</span><span id="__span-28-2">dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>/dev/zero<span class="w"> </span><span class="nv">of</span><span class="o">=</span>/gmiao/gm<span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">bs</span><span class="o">=</span>100M
</span><span id="__span-28-3">umount<span class="w"> </span>/gmiao
</span><span id="__span-28-4">lvconvert<span class="w"> </span>--merge<span class="w"> </span>/dev/storage/snap
</span><span id="__span-28-5">mount<span class="w"> </span>-a
</span></code></pre></div></td></tr></table></div>
<h4 id="_17">删除逻辑卷<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1">umount<span class="w"> </span>/gmiao
</span><span id="__span-29-2">删除fstab关联项
</span><span id="__span-29-3">lvremove<span class="w"> </span>/dev/storage/vo
</span><span id="__span-29-4">vgremove<span class="w"> </span>storage
</span><span id="__span-29-5">pvremove<span class="w"> </span>/dev/sdf<span class="w"> </span>/dev/sdg
</span></code></pre></div></td></tr></table></div>
<h2 id="4iptablesfirewalld">4.iptables和firewalld防火墙<a class="headerlink" href="#4iptablesfirewalld" title="Permanent link">&para;</a></h2>
<h3 id="iptables">iptables<a class="headerlink" href="#iptables" title="Permanent link">&para;</a></h3>
<p>表8-1 iptables中常用的参数以及作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-P</td>
<td>设置默认策略</td>
</tr>
<tr>
<td>-F</td>
<td>清空规则链</td>
</tr>
<tr>
<td>-L</td>
<td>查看规则链</td>
</tr>
<tr>
<td>-A</td>
<td>在规则链的末尾加入新规则</td>
</tr>
<tr>
<td>-I num</td>
<td>在规则链的头部加入新规则</td>
</tr>
<tr>
<td>-D num</td>
<td>删除某一条规则</td>
</tr>
<tr>
<td>-s</td>
<td>匹配来源地址IP/MASK，加叹号“!”表示除这个IP外</td>
</tr>
<tr>
<td>-d</td>
<td>匹配目标地址</td>
</tr>
<tr>
<td>-i 网卡名称</td>
<td>匹配从这块网卡流入的数据</td>
</tr>
<tr>
<td>-o 网卡名称</td>
<td>匹配从这块网卡流出的数据</td>
</tr>
<tr>
<td>-p</td>
<td>匹配协议，如TCP、UDP、ICMP</td>
</tr>
<tr>
<td>--dport num</td>
<td>匹配目标端口号</td>
</tr>
<tr>
<td>--sport num</td>
<td>匹配来源端口号</td>
</tr>
</tbody>
</table>
<blockquote>
<p>防火墙的策略规则是按照从上到下的顺序匹配的，所以一定要把允许动作放在拒绝动作前面，否则所有的流量都会被拒绝。(针对单条规则)
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><span class="c1"># 将INPUT规则链设置为只允许指定网段的主机访问本机的22端口，拒绝来自其他所有主机的流量。</span>
</span><span id="__span-30-2">iptables<span class="w"> </span>-I<span class="w"> </span>INPUT<span class="w"> </span>-s<span class="w"> </span><span class="m">192</span>.168.10.0/24<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-30-3">iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>-j<span class="w"> </span>REJECT
</span><span id="__span-30-4"><span class="c1"># 向INPUT规则链中添加拒绝所有人访问本机12345端口的策略规则。</span>
</span><span id="__span-30-5">
</span><span id="__span-30-6">iptables<span class="w"> </span>-I<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">12345</span><span class="w"> </span>-j<span class="w"> </span>REJECT
</span><span id="__span-30-7">iptables<span class="w"> </span>-I<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>udp<span class="w"> </span>--dport<span class="w"> </span><span class="m">12345</span><span class="w"> </span>-j<span class="w"> </span>REJECT
</span><span id="__span-30-8"><span class="c1"># 向INPUT规则链中添加拒绝192.168.10.5主机访问本机80端口（Web服务）的策略规则。</span>
</span><span id="__span-30-9">
</span><span id="__span-30-10">iptables<span class="w"> </span>-I<span class="w"> </span>INPUT<span class="w"> </span>-s<span class="w"> </span><span class="m">192</span>.168.10.5<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">80</span><span class="w"> </span>-j<span class="w"> </span>REJECT
</span><span id="__span-30-11"><span class="c1"># 向INPUT规则链中添加拒绝所有主机访问本机1000～1024端口的策略规则。</span>
</span><span id="__span-30-12">
</span><span id="__span-30-13">iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">1000</span>:1024<span class="w"> </span>-j<span class="w"> </span>REJECT
</span><span id="__span-30-14">iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>udp<span class="w"> </span>--dport<span class="w"> </span><span class="m">1000</span>:1024<span class="w"> </span>-j<span class="w"> </span>REJECT
</span><span id="__span-30-15">iptables-save
</span></code></pre></div></td></tr></table></div></p>
</blockquote>
<h3 id="firewalld">firewalld<a class="headerlink" href="#firewalld" title="Permanent link">&para;</a></h3>
<p>表8-2 firewalld中常用的区域名称及策略规则</p>
<table>
<thead>
<tr>
<th>区域</th>
<th>默认规则策略</th>
</tr>
</thead>
<tbody>
<tr>
<td>trusted</td>
<td>允许所有的数据包</td>
</tr>
<tr>
<td>home</td>
<td>拒绝流入的流量，除非与流出的流量相关；而如果流量与ssh、mdns、ipp-client、amba-client与dhcpv6-client服务相关，则允许流量</td>
</tr>
<tr>
<td>internal</td>
<td>等同于home区域</td>
</tr>
<tr>
<td>work</td>
<td>拒绝流入的流量，除非与流出的流量相关；而如果流量与ssh、ipp-client与dhcpv6-client服务相关，则允许流量</td>
</tr>
<tr>
<td>public</td>
<td>拒绝流入的流量，除非与流出的流量相关；而如果流量与ssh、dhcpv6-client服务相关，则允许流量</td>
</tr>
<tr>
<td>external</td>
<td>拒绝流入的流量，除非与流出的流量相关；而如果流量与ssh服务相关，则允许流量</td>
</tr>
<tr>
<td>dmz</td>
<td>拒绝流入的流量，除非与流出的流量相关；而如果流量与ssh服务相关，则允许流量</td>
</tr>
<tr>
<td>block</td>
<td>拒绝流入的流量，除非与流出的流量相关</td>
</tr>
<tr>
<td>drop</td>
<td>拒绝流入的流量，除非与流出的流量相关</td>
</tr>
<tr>
<td>- 终端管理工具</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>表8-3 firewall-cmd命令中使用的参数以及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>--get-default-zone</td>
<td>查询默认的区域名称</td>
</tr>
<tr>
<td>--set-default-zone=&lt;区域名称&gt;</td>
<td>设置默认的区域，使其永久生效</td>
</tr>
<tr>
<td>--get-zones</td>
<td>显示可用的区域</td>
</tr>
<tr>
<td>--get-services</td>
<td>显示预先定义的服务</td>
</tr>
<tr>
<td>--get-active-zones</td>
<td>显示当前正在使用的区域与网卡名称</td>
</tr>
<tr>
<td>--add-source=</td>
<td>将源自此IP或子网的流量导向指定的区域</td>
</tr>
<tr>
<td>--remove-source=</td>
<td>不再将源自此IP或子网的流量导向某个指定区域</td>
</tr>
<tr>
<td>--add-interface=&lt;网卡名称&gt;</td>
<td>将源自该网卡的所有流量都导向某个指定区域</td>
</tr>
<tr>
<td>--change-interface=&lt;网卡名称&gt;</td>
<td>将某个网卡与区域进行关联</td>
</tr>
<tr>
<td>--list-all</td>
<td>显示当前区域的网卡配置参数、资源、端口以及服务等信息</td>
</tr>
<tr>
<td>--list-all-zones</td>
<td>显示所有区域的网卡配置参数、资源、端口以及服务等信息</td>
</tr>
<tr>
<td>--add-service=&lt;服务名&gt;</td>
<td>设置默认区域允许该服务的流量</td>
</tr>
<tr>
<td>--add-port=&lt;端口号/协议&gt;</td>
<td>设置默认区域允许该端口的流量</td>
</tr>
<tr>
<td>--remove-service=&lt;服务名&gt;</td>
<td>设置默认区域不再允许该服务的流量</td>
</tr>
<tr>
<td>--remove-port=&lt;端口号/协议&gt;</td>
<td>设置默认区域不再允许该端口的流量</td>
</tr>
<tr>
<td>--reload</td>
<td>让“永久生效”的配置规则立即生效，并覆盖当前的配置规则</td>
</tr>
<tr>
<td>--panic-on</td>
<td>开启应急状况模式</td>
</tr>
<tr>
<td>--panic-off</td>
<td>关闭应急状况模式</td>
</tr>
</tbody>
</table>
<ul>
<li>查看firewalld服务当前所使用的区域。
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1">firewall-cmd<span class="w"> </span>--get-default-zone
</span><span id="__span-31-2">查询指定网卡在firewalld服务中绑定的区域
</span><span id="__span-31-3">
</span><span id="__span-31-4">firewall-cmd<span class="w"> </span>--get-zone-of-interface<span class="o">=</span>ens33
</span><span id="__span-31-5">把网卡默认区域修改为external，并在系统重启后生效
</span><span id="__span-31-6">
</span><span id="__span-31-7">firewall-cmd<span class="w"> </span>--permanent<span class="w"> </span>--zone<span class="o">=</span>external<span class="w"> </span>--change-interface<span class="o">=</span>ens33
</span><span id="__span-31-8">firewall-cmd<span class="w"> </span>--get-zone-of-interface<span class="o">=</span>ens33<span class="w"> </span>--permanent
</span><span id="__span-31-9">启动和关闭firewalld防火墙服务的应急状况模式。
</span><span id="__span-31-10">
</span><span id="__span-31-11">firewall-cmd<span class="w"> </span>--panic-on
</span><span id="__span-31-12">firewall-cmd<span class="w"> </span>--panic-off
</span><span id="__span-31-13">查询SSH和HTTPS协议的流量是否允许放行。
</span><span id="__span-31-14">
</span><span id="__span-31-15"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-service=ssh</span>
</span><span id="__span-31-16">yes
</span><span id="__span-31-17"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-service=https</span>
</span><span id="__span-31-18">no
</span><span id="__span-31-19">把HTTPS协议的流量设置为永久允许放行，并立即生效
</span><span id="__span-31-20">
</span><span id="__span-31-21"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --add-service=https</span>
</span><span id="__span-31-22">success
</span><span id="__span-31-23"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-service=https</span>
</span><span id="__span-31-24">no
</span><span id="__span-31-25"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --reload </span>
</span><span id="__span-31-26">success
</span><span id="__span-31-27"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-service=https</span>
</span><span id="__span-31-28">yes
</span><span id="__span-31-29">把HTTP协议的流量设置为永久拒绝，并立即生效
</span><span id="__span-31-30">
</span><span id="__span-31-31"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --remove-service=http</span>
</span><span id="__span-31-32">Warning:<span class="w"> </span>NOT_ENABLED:<span class="w"> </span>http
</span><span id="__span-31-33">success
</span><span id="__span-31-34"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-service=http</span>
</span><span id="__span-31-35">no
</span><span id="__span-31-36"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --reload </span>
</span><span id="__span-31-37">success
</span><span id="__span-31-38"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-service=http</span>
</span><span id="__span-31-39">no
</span><span id="__span-31-40">
</span><span id="__span-31-41">把访问8080和8081端口的流量策略设置为允许，但仅限当前生效
</span><span id="__span-31-42">
</span><span id="__span-31-43"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --add-port=8080-8081/tcp</span>
</span><span id="__span-31-44">success
</span><span id="__span-31-45"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-port=8080-8081</span>
</span><span id="__span-31-46">Error:<span class="w"> </span>INVALID_PORT:<span class="w"> </span>bad<span class="w"> </span>port<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>likely<span class="w"> </span>missing<span class="w"> </span>protocol<span class="o">)</span>,<span class="w"> </span>correct<span class="w"> </span>syntax<span class="w"> </span>is<span class="w"> </span>portid<span class="o">[</span>-portid<span class="o">]</span>/protocol
</span><span id="__span-31-47"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-port=8080</span>
</span><span id="__span-31-48">Error:<span class="w"> </span>INVALID_PORT:<span class="w"> </span>bad<span class="w"> </span>port<span class="w"> </span><span class="o">(</span>most<span class="w"> </span>likely<span class="w"> </span>missing<span class="w"> </span>protocol<span class="o">)</span>,<span class="w"> </span>correct<span class="w"> </span>syntax<span class="w"> </span>is<span class="w"> </span>portid<span class="o">[</span>-portid<span class="o">]</span>/protocol
</span><span id="__span-31-49"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-port=8080/tcp</span>
</span><span id="__span-31-50">yes
</span><span id="__span-31-51"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --query-port=8080-8081/tcp</span>
</span><span id="__span-31-52">yes
</span><span id="__span-31-53">把原本访问本机888端口的流量转发到22端口，要且求当前和长期均有效
</span><span id="__span-31-54">
</span><span id="__span-31-55"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --add-forward-port=port=888:proto=tcp:toport=22:toaddr=192.168.10.10</span>
</span><span id="__span-31-56">success
</span><span id="__span-31-57"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --reload </span>
</span><span id="__span-31-58">success
</span><span id="__span-31-59">富规则的设置
</span><span id="__span-31-60">
</span><span id="__span-31-61"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># man firewall-cmd</span>
</span><span id="__span-31-62">man<span class="w"> </span>firewalld.richlanguage
</span><span id="__span-31-63"><span class="o">[</span>--permanent<span class="o">]</span><span class="w"> </span><span class="o">[</span>--zone<span class="o">=</span>zone<span class="o">]</span><span class="w"> </span>--add-rich-rule<span class="o">=</span><span class="s1">&#39;rule family=&quot;ipv6&quot; source address=&quot;1:2:3:4:6::&quot; service name=&quot;radius&quot; log prefix=&quot;dns&quot; level=&quot;info&quot; limit value=&quot;3/m&quot; reject&#39;</span>
</span><span id="__span-31-64">
</span><span id="__span-31-65"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.10.0/24&quot; service name=&quot;ssh&quot; reject&quot;</span>
</span><span id="__span-31-66">success
</span><span id="__span-31-67"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --reload</span>
</span><span id="__span-31-68">success
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="_18">图形管理工具<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>firewall-config</p>
<h3 id="_19">服务的访问控制列表<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1">root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/hosts.deny</span>
</span><span id="__span-32-2">sshd:*
</span><span id="__span-32-3"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/hosts.allow</span>
</span><span id="__span-32-4">sshd:192.168.10.
</span></code></pre></div></td></tr></table></div>
<h3 id="cockpit">Cockpit驾驶舱管理工具<a class="headerlink" href="#cockpit" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1">总共分为十三个功能模块，即：系统状态、日志信息、硬盘存储、网卡网络、账户安全、服务程序、软件仓库、报告分析、内核排错、SElinux、更新软件、订阅服务、终端界面。
</span><span id="__span-33-2">
</span><span id="__span-33-3">System
</span><span id="__span-33-4">
</span><span id="__span-33-5">类似web版的任务管理器
</span><span id="__span-33-6">Logs
</span><span id="__span-33-7">
</span><span id="__span-33-8">可根据时间和日志级别查询日志
</span><span id="__span-33-9">Storage
</span><span id="__span-33-10">
</span><span id="__span-33-11">可以简单的创建RAIDD、LVM、VDO、iSCSI等存储设备
</span><span id="__span-33-12">Networking
</span><span id="__span-33-13">
</span><span id="__span-33-14">动态查看网卡的输出和接受值，还可进行网卡的绑定、聚合、创建桥接网卡、添加vlan，列出网卡相关的日志信息
</span><span id="__span-33-15">Accounts
</span><span id="__span-33-16">
</span><span id="__span-33-17">可以对用户进行管理
</span><span id="__span-33-18">Services
</span><span id="__span-33-19">
</span><span id="__span-33-20">可查看服务并进行管理（包括停止启动等），点击单个服务，下面还有相关的日志信息
</span><span id="__span-33-21">Applications
</span><span id="__span-33-22">
</span><span id="__span-33-23">软件仓库
</span><span id="__span-33-24">Diagnostic Report
</span><span id="__span-33-25">
</span><span id="__span-33-26">sosreport
</span><span id="__span-33-27">Kernel Dump
</span><span id="__span-33-28">
</span><span id="__span-33-29">内核排错
</span><span id="__span-33-30">SElinux
</span><span id="__span-33-31">
</span><span id="__span-33-32">Terminal（运维常用）
</span></code></pre></div></td></tr></table></div>
<h2 id="5ssh">5.使用ssh服务管理远程主机<a class="headerlink" href="#5ssh" title="Permanent link">&para;</a></h2>
<h3 id="_20">配置网卡服务<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<ul>
<li>配置网卡参数</li>
</ul>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1">nmtui
</span><span id="__span-34-2">
</span><span id="__span-34-3"><span class="nv">ONBOOT</span><span class="o">=</span>yes（重启后网卡激活）
</span><span id="__span-34-4">nmcli<span class="w"> </span>connection<span class="w"> </span>reload<span class="w"> </span>ens33
</span><span id="__span-34-5">nmcli<span class="w"> </span>connection<span class="w"> </span>up<span class="w"> </span>ens33
</span></code></pre></div></td></tr></table></div>
<ul>
<li>创建网络会话（实现不用频繁的更改ip）</li>
<li>
<div class="language-text highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>```bash
[root@192 ~]# nmcli connection add con-name company ifname ens33 autoconnect no type ethernet ip4 192.168.10.10/24 gw4 192.168.10.2
[root@192 ~]# nmcli connection show
[root@192 ~]# nmcli connection up company (开启会话，表示当前可用的是这个会话=连接)
[root@192 ~]# nmcli connection delete company （删除不用的会话）
```
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>绑定两块网卡</p>
</li>
<li>
<p>round-robin(轮循模式)</p>
<ul>
<li>
<p>根据设备的顺序依次传输数据包，一台网卡发生故障，会切换到另一台上，网络不会断
      <div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><span class="c1">### 创建一个bond网卡</span>
</span><span id="__span-36-2"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># nmcli connection add type bond con-name bond0 ifname bond0 bond.options &quot;mode=balance-rr&quot;</span>
</span><span id="__span-36-3">Connection<span class="w"> </span><span class="s1">&#39;bond0&#39;</span><span class="w"> </span><span class="o">(</span>2525bc21-b229-4a94-b2a9-d2d4f47bfba1<span class="o">)</span><span class="w"> </span>successfully<span class="w"> </span>added
</span><span id="__span-36-4"><span class="c1">#### 向bond0中添加从属网卡</span>
</span><span id="__span-36-5">
</span><span id="__span-36-6"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># nmcli connection add type ethernet slave-type bond con-name bond0-port1 ifname ens33 master bond0</span>
</span><span id="__span-36-7">
</span><span id="__span-36-8">
</span><span id="__span-36-9"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># nmcli connection add type ethernet slave-type bond con-name bond0-port2 ifname ens37 master bond0</span>
</span><span id="__span-36-10">
</span><span id="__span-36-11">
</span><span id="__span-36-12"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># nmcli connection up bond0</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>提供负载均衡的效果，带宽的性能更好</p>
</li>
</ul>
</li>
</ul>
<p>active-backup(主备模式)</p>
<p>一台网卡发生损坏，另一个会自动顶上，冗余能力较强</p>
<h3 id="_21">远程控制服务<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<ul>
<li>配置sshd服务,编辑（/etc/ssh/sshd_config）文件</li>
<li>sshd提供两种安全验证的方式（基于密码的验证，基于密钥的验证）</li>
</ul>
<blockquote>
<p>基于密码的验证—用账户和密码来验证登录；
基于密钥的验证—需要在本地生成密钥对，然后把密钥对中的公钥上传至服务器，并与服务器中的公钥进行比较；该方式相较来说更安全。</p>
</blockquote>
<ul>
<li>表9-1 sshd服务配置文件（/etc/ssh/sshd_config）中包含的参数以及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>Port 22</td>
<td>默认的sshd服务端口</td>
</tr>
<tr>
<td>ListenAddress 0.0.0.0</td>
<td>设定sshd服务器监听的IP地址</td>
</tr>
<tr>
<td>Protocol 2</td>
<td>SSH协议的版本号</td>
</tr>
<tr>
<td>HostKey /tc/ssh/ssh_host_key</td>
<td>SSH协议版本为1时，DES私钥存放的位置</td>
</tr>
<tr>
<td>HostKey /etc/ssh/ssh_host_rsa_key</td>
<td>SSH协议版本为2时，RSA私钥存放的位置</td>
</tr>
<tr>
<td>HostKey /etc/ssh/ssh_host_dsa_key</td>
<td>SSH协议版本为2时，DSA私钥存放的位置</td>
</tr>
<tr>
<td>PermitRootLogin yes</td>
<td>设定是否允许root管理员直接登录</td>
</tr>
<tr>
<td>StrictModes yes</td>
<td>当远程用户的私钥改变时直接拒绝连接</td>
</tr>
<tr>
<td>MaxAuthTries 6</td>
<td>最大密码尝试次数</td>
</tr>
<tr>
<td>MaxSessions 10</td>
<td>最大终端数</td>
</tr>
<tr>
<td>PasswordAuthentication yes</td>
<td>是否允许密码验证</td>
</tr>
<tr>
<td>PermitEmptyPasswords no</td>
<td>是否允许空密码登录（很不安全）</td>
</tr>
</tbody>
</table>
<h4 id="_22">安全密钥验证<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><span class="c1">#在客户端主机中生成密钥对</span>
</span><span id="__span-37-2">ssh-keygen
</span><span id="__span-37-3"><span class="c1">#将客户端中生成的公钥文件发送到服务器</span>
</span><span id="__span-37-4">
</span><span id="__span-37-5">ssh-copy-id<span class="w"> </span>root@192.168.10.10
</span><span id="__span-37-6">ssh<span class="w"> </span>root@192.168.10.10
</span><span id="__span-37-7">PasswordAuthentication<span class="w"> </span>no<span class="w"> </span><span class="o">(</span>禁止密码登录<span class="o">)</span>
</span><span id="__span-37-8"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart sshd</span>
</span><span id="__span-37-9"><span class="c1">#windows将公钥复制到Linux，将文件内容追加到.ssh/authorized_keys文件中，重启sshd服务，就可以实现密钥远程连接</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>远程传输命令</li>
<li>表9-3 scp命令中可用的参数及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-v</td>
<td>显示详细的连接进度</td>
</tr>
<tr>
<td>-P</td>
<td>指定远程主机的sshd端口号</td>
</tr>
<tr>
<td>-r</td>
<td>用于传送文件夹</td>
</tr>
<tr>
<td>-6</td>
<td>使用IPv6协议</td>
</tr>
</tbody>
</table>
<h3 id="_23">不间断会话服务<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Tmux管理远程会话
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># tmux</span>
</span><span id="__span-38-2"><span class="o">[</span>exited<span class="o">]</span>
</span><span id="__span-38-3"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># tmux new -s backup  （新建会话）</span>
</span><span id="__span-38-4"><span class="o">[</span>detached<span class="o">]</span>
</span><span id="__span-38-5"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># tmux ls   （查看有哪些后台会话）</span>
</span><span id="__span-38-6">backup:<span class="w"> </span><span class="m">1</span><span class="w"> </span>windows<span class="w"> </span><span class="o">(</span>created<span class="w"> </span>Mon<span class="w"> </span>Sep<span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">16</span>:13:21<span class="w"> </span><span class="m">2022</span><span class="o">)</span><span class="w"> </span><span class="o">[</span>60x19<span class="o">]</span>
</span><span id="__span-38-7">
</span><span id="__span-38-8">
</span><span id="__span-38-9"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># tmux attach -t backup  （返回i会话）</span>
</span><span id="__span-38-10"><span class="o">[</span>exited<span class="o">]</span>
</span><span id="__span-38-11"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># tmux ls</span>
</span><span id="__span-38-12">failed<span class="w"> </span>to<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>server
</span><span id="__span-38-13"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># tmux new &quot;vim yma.a&quot;    （直接执行命令，完成之后推出会话）</span>
</span><span id="__span-38-14"><span class="o">[</span>exited<span class="o">]</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>管理多窗格</p>
</li>
<li>Tmux服务为用户提供了一系列快捷键来执行窗格的切换。方法是先同时按下Ctrl+B组合键，然后松手后再迅速按下其他后续按键，而不是一起按下。</li>
<li>表9-5 Tmux会话窗格相关的常用快捷键</li>
</ul>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>%</td>
<td>划分左右两个窗格</td>
</tr>
<tr>
<td>"</td>
<td>划分上下两个窗格</td>
</tr>
<tr>
<td>&lt;方向键&gt;</td>
<td>切换到上下左右相邻的一个窗格</td>
</tr>
<tr>
<td>;</td>
<td>切换至上一个窗格</td>
</tr>
<tr>
<td>o</td>
<td>切换至下一个窗格</td>
</tr>
<tr>
<td>{</td>
<td>将当前窗格与上一个窗格位置互换</td>
</tr>
<tr>
<td>}</td>
<td>将当前窗格与下一个窗格位置互换</td>
</tr>
<tr>
<td>x</td>
<td>关闭窗格</td>
</tr>
<tr>
<td>!</td>
<td>将当前窗格拆分成独立窗口</td>
</tr>
<tr>
<td>q</td>
<td>显示窗格编号</td>
</tr>
<tr>
<td>会话共享</td>
<td></td>
</tr>
</tbody>
</table>
<p>tmux new -s share
tmux attach-session -t share</p>
<h3 id="_24">检索日志信息<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>在RHEL 8系统中，默认的日志服务程序是rsyslog</p>
</li>
<li>
<p>表9-7 常见的日志文件保存路径</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>文件路径及命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>/var/log/boot.log</td>
<td>系统开机自检事件及引导过程等信息</td>
</tr>
<tr>
<td>/var/log/lastlog</td>
<td>用户登录成功时间、终端名称及IP地址等信息</td>
</tr>
<tr>
<td>/var/log/btmp</td>
<td>记录登录失败的时间、终端名称及IP地址等信息</td>
</tr>
<tr>
<td>/var/log/messages</td>
<td>系统及各个服务的运行和报错信息</td>
</tr>
<tr>
<td>/var/log/secure</td>
<td>系统安全相关的信息</td>
</tr>
<tr>
<td>/var/log/wtmp</td>
<td>系统启动与关机等相关信息</td>
</tr>
<tr>
<td>- 从理论上讲，日志文件分为下面3种类型。在日常工作中，/var/log/message这个综合性的文件用得最多</td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>系统日志：主要记录系统的运行情况和内核信息。
用户日志：主要记录用户的访问信息，包含用户名、终端名称、登入及退出时间、来源IP地址和执行过的操作等。
程序日志：稍微大一些的服务一般都会保存一份与其同名的日志文件，里面记录着服务运行过程中各种事件的信息；每个服务程序都有自己独立的日志文件，且格式相差较大。</p>
</blockquote>
<ul>
<li>
<p>journalctl它可以根据事件、类型、服务名称等信息进行信息检索，从而大大提高了日常排错的效率。</p>
</li>
<li>
<p>表9-7 journalctl命令中常用按键以及作用</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-k</td>
<td>内核日志</td>
</tr>
<tr>
<td>-b</td>
<td>启动日志</td>
</tr>
<tr>
<td>-u</td>
<td>指定服务</td>
</tr>
<tr>
<td>-n</td>
<td>指定条数</td>
</tr>
<tr>
<td>-p</td>
<td>指定类型</td>
</tr>
<tr>
<td>-f</td>
<td>实时刷新（追踪日志）</td>
</tr>
<tr>
<td>--since</td>
<td>指定时间</td>
</tr>
<tr>
<td>--disk-usage</td>
<td>占用空间</td>
</tr>
</tbody>
</table>
<ul>
<li>表9-9 日志信息登记分类</li>
</ul>
<table>
<thead>
<tr>
<th>日志等级</th>
<th>说明介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>emerg</td>
<td>系统出现严重故障，内核崩溃等情况</td>
</tr>
<tr>
<td>alert</td>
<td>应立即修复的故障，数据库损坏等情况</td>
</tr>
<tr>
<td>crit</td>
<td>危险较高的故障，硬盘损坏导致程序运行失败的情况</td>
</tr>
<tr>
<td>err</td>
<td>一般危险的故障，某个服务启动或运行失败的情况</td>
</tr>
<tr>
<td>warning</td>
<td>警告信息，某个服务参数或功能错误的情况</td>
</tr>
<tr>
<td>notice</td>
<td>一般无危险的故障，只是需要处理的情况</td>
</tr>
<tr>
<td>info</td>
<td>通用性消息，给用户提示一些有用信息</td>
</tr>
<tr>
<td>debug</td>
<td>调试程序所产生的信息</td>
</tr>
<tr>
<td>none</td>
<td>没有优先级，不做日志记录</td>
</tr>
</tbody>
</table>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># journalctl -p crit   （按级别查询）</span>
</span><span id="__span-39-2"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># journalctl --since today</span>
</span><span id="__span-39-3"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># journalctl --since &quot;-1 hour&quot;   (最近一小时的日志)</span>
</span><span id="__span-39-4"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># journalctl --since &quot;15:00&quot; --until &quot;16:00&quot;</span>
</span><span id="__span-39-5">（指定时间段日志）
</span><span id="__span-39-6"><span class="o">[</span>root@server<span class="w"> </span>~<span class="o">]</span><span class="c1"># journalctl  -u sshd  （查看某个服务的日志）</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="6apache">6.使用apache服务部署静态网站<a class="headerlink" href="#6apache" title="Permanent link">&para;</a></h2>
<h3 id="_25">网站服务程序<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<p>Apache服务程序可以运行在Linux系统、UNIX系统甚至是Windows系统中，它支持基于IP、域名及端口号的虚拟主机功能，支持多种认证方式，集成有代理服务器模块、安全Socket层（SSL），能够实时监视服务状态与定制日志消息，并支持各类丰富的模块。</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1">yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>httpd
</span><span id="__span-40-2">systemctl<span class="w"> </span>start<span class="w"> </span>httpd
</span><span id="__span-40-3">systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>httpd
</span><span id="__span-40-4">全局配置参数是一种全局性的配置参数，可作用于所有的子站点；区域配置参数<span class="w"> </span><span class="o">(</span>写在中的<span class="o">)</span><span class="w"> </span>则是单独针对每个独立的子站点设置的；而注释行信息一般是对服务程序的功能或某一行参数进行介绍的。
</span></code></pre></div></td></tr></table></div>
<h3 id="_26">配置服务文件参数<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<ul>
<li>表10-1 Linux系统中的httpd配置文件</li>
</ul>
<table>
<thead>
<tr>
<th>作用</th>
<th>文件名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>服务目录</td>
<td>/etc/httpd</td>
</tr>
<tr>
<td>主配置文件</td>
<td>/etc/httpd/conf/httpd.conf</td>
</tr>
<tr>
<td>网站数据目录</td>
<td>/var/www/html</td>
</tr>
<tr>
<td>访问日志</td>
<td>/var/log/httpd/access_log</td>
</tr>
<tr>
<td>错误日志</td>
<td>/var/log/httpd/error_log</td>
</tr>
</tbody>
</table>
<ul>
<li>表10-2 配置httpd服务程序时最常用的参数以及用途描述</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>ServerRoot</td>
<td>服务目录</td>
</tr>
<tr>
<td>ServerAdmin</td>
<td>管理员邮箱</td>
</tr>
<tr>
<td>User</td>
<td>运行服务的用户</td>
</tr>
<tr>
<td>Group</td>
<td>运行服务的用户组</td>
</tr>
<tr>
<td>ServerName</td>
<td>网站服务器的域名</td>
</tr>
<tr>
<td>DocumentRoot</td>
<td>网站数据目录</td>
</tr>
<tr>
<td>Listen</td>
<td>监听的IP地址与端口号</td>
</tr>
<tr>
<td>DirectoryIndex</td>
<td>默认的索引页页面</td>
</tr>
<tr>
<td>ErrorLog</td>
<td>错误日志文件</td>
</tr>
<tr>
<td>CustomLog</td>
<td>访问日志文件</td>
</tr>
<tr>
<td>Timeout</td>
<td>网页超时时间，默认为300秒</td>
</tr>
</tbody>
</table>
<ul>
<li>建立网站数据的保存目录，创建首页文件
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-41-1">mkdir<span class="w"> </span>/home/wwwroot
</span><span id="__span-41-2"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;this is new web site pagemkdir /home/wwwroot&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/home/wwwroot/index.html
</span><span id="__span-41-3">vim<span class="w"> </span>/etc/httpd/conf/httpd.conf
</span><span id="__span-41-4">DocumentRoot<span class="w"> </span><span class="s2">&quot;/home/wwwroot&quot;</span>
</span><span id="__span-41-5">&lt;Directory<span class="w"> </span><span class="s2">&quot;/home/wwwroot&quot;</span>&gt;
</span><span id="__span-41-6">AllowOverride<span class="w"> </span>None
</span><span id="__span-41-7"><span class="c1"># Allow open access:</span>
</span><span id="__span-41-8">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-41-9">&lt;/Directory&gt;
</span><span id="__span-41-10"><span class="c1"># Further relax access to the default document root:</span>
</span><span id="__span-41-11">&lt;Directory<span class="w"> </span><span class="s2">&quot;/home/wwwroot&quot;</span>&gt;
</span><span id="__span-41-12">
</span><span id="__span-41-13"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># systemctl restart httpd</span>
</span><span id="__span-41-14"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># semanage fcontext -a -t httpd_sys_content_t &quot;/home/wwwroot/index.html&quot;</span>
</span><span id="__span-41-15"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># restorecon -R -v /home/wwwroot/index.html</span>
</span><span id="__span-41-16"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># ll -Z</span>
</span><span id="__span-41-17">-rw-r--r--.<span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span>unconfined_u:object_r:httpd_sys_content_t:s0<span class="w"> </span>index.html
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="selinux_1">SELinux安全子系统<a class="headerlink" href="#selinux_1" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>SELinux安全上下文确保文件资源只能被其所属的服务程序进行访问</p>
</li>
<li>
<p>SELinux服务有3种配置模式，具体如下。</p>
<blockquote>
<p>enforcing：强制启用安全策略模式，将拦截服务的不合法请求。
permissive：遇到服务越权访问时，只发出警告而不强制拦截。
disabled：对于越权的行为不警告也不拦截。</p>
</blockquote>
</li>
<li>
<p>表10-3 semanage命令中常用参数以及作用</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-l</td>
<td>查询</td>
</tr>
<tr>
<td>-a</td>
<td>添加</td>
</tr>
<tr>
<td>-m</td>
<td>修改</td>
</tr>
<tr>
<td>-d</td>
<td>删除</td>
</tr>
<tr>
<td><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-42-1"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># semanage fcontext -a -t httpd_sys_content_t &quot;/home/wwwroot</span>
</span><span id="__span-42-2"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># semanage fcontext -a -t httpd_sys_content_t &quot;/home/wwwroot/*</span>
</span><span id="__span-42-3"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># restorecon -R -v /home/wwwroot/index.html</span>
</span></code></pre></div></td></tr></table></div></td>
<td></td>
</tr>
<tr>
<td>### 个人用户主页功能</td>
<td></td>
</tr>
<tr>
<td>- userdir</td>
<td></td>
</tr>
<tr>
<td><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-43-1"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># vim /etc/httpd/conf.d/userdir.conf </span>
</span><span id="__span-43-2"><span class="w">    </span><span class="c1">#UserDir disabled</span>
</span><span id="__span-43-3"><span class="w">    </span>UserDir<span class="w"> </span>public_html<span class="w">  </span>（网站数据在用户家目录中的保存目录名称：public_html）
</span><span id="__span-43-4"><span class="o">[</span>minayao@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">755</span><span class="w"> </span>./
</span><span id="__span-43-5"><span class="o">[</span>minayao@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>mkdir<span class="w"> </span>public_html
</span><span id="__span-43-6"><span class="o">[</span>minayao@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;This is yma&#39;s site pageecho ！！！ &quot;</span><span class="w"> </span>&gt;<span class="w"> </span>public_html/index.html
</span><span id="__span-43-7"><span class="o">[</span>minayao@server<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>httpd
</span><span id="__span-43-8"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># firefox </span>
</span><span id="__span-43-9"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1">#  setsebool -P httpd_read_user_content=on</span>
</span><span id="__span-43-10"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># getsebool -a | grep http</span>
</span><span id="__span-43-11"><span class="o">[</span>root@server<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1">#  setsebool -P httpd_enable_homedirs=on</span>
</span></code></pre></div></td></tr></table></div></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>为个人主页设置密码
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-44-1">htpasswd<span class="w"> </span>-c<span class="w"> </span>/etc/httpd/passwd<span class="w"> </span>minayao
</span><span id="__span-44-2">
</span><span id="__span-44-3">vim<span class="w"> </span>/etc/httpd/conf.d/userdir.conf
</span><span id="__span-44-4">
</span><span id="__span-44-5">&lt;Directory<span class="w"> </span><span class="s2">&quot;/home/*/public_html&quot;</span>&gt;
</span><span id="__span-44-6"><span class="w">    </span>AllowOverride<span class="w"> </span>all
</span><span id="__span-44-7"><span class="w">    </span>authuserfile<span class="w"> </span><span class="s2">&quot;/etc/httpd/passwd&quot;</span>
</span><span id="__span-44-8"><span class="w">    </span>authname<span class="w"> </span><span class="s2">&quot;My paivately website&quot;</span>
</span><span id="__span-44-9"><span class="w">    </span>authtype<span class="w"> </span>basic
</span><span id="__span-44-10"><span class="w">    </span>Require<span class="w"> </span>user<span class="w"> </span>minayao
</span><span id="__span-44-11">&lt;/Directory&gt;
</span><span id="__span-44-12">systemctl<span class="w"> </span>restart<span class="w"> </span>httpd
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>网页中输入用户名和密码</p>
</li>
</ul>
<h3 id="_27">虚拟网站主机<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>基于IP地址（一台机器有多个IP地址）
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-45-1"><span class="o">[</span>root@localhost<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># ping -c 4 192.168.10.30</span>
</span><span id="__span-45-2">（检查三个地址的连通性）
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>新建不同IP网站的数据目录，并写入主页
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-46-1">mkdir<span class="w"> </span>-p<span class="w"> </span>/home/wwwroot/10
</span><span id="__span-46-2">mkdir<span class="w"> </span>-p<span class="w"> </span>/home/wwwroot/20
</span><span id="__span-46-3">mkdir<span class="w"> </span>-p<span class="w"> </span>/home/wwwroot/30
</span><span id="__span-46-4"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;IP:192.168.10.10&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/home/wwwroot/10/index.html
</span><span id="__span-46-5"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;IP:192.168.10.20&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/home/wwwroot/20/index.html
</span><span id="__span-46-6"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;IP:192.168.10.30&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/home/wwwroot/30/index.html
</span><span id="__span-46-7">semanage<span class="w"> </span>fcontext<span class="w"> </span>-a<span class="w"> </span>-t<span class="w"> </span>httpd_sys_content_t<span class="w"> </span><span class="s2">&quot;/home/wwwroot/10/index.html&quot;</span>
</span><span id="__span-46-8">（添加selinux安全上下文）
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>修改httpd.conf中的权限设置
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-47-1"><span class="c1">#虚拟主机设置（基于IP地址）</span>
</span><span id="__span-47-2">NameVirtualHost<span class="w"> </span>*:80
</span><span id="__span-47-3">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.10&gt;
</span><span id="__span-47-4"><span class="w">        </span>DocumentRoot<span class="w"> </span>/home/wwwroot/10
</span><span id="__span-47-5"><span class="w">        </span>ServerName<span class="w"> </span>www.minayao10.com
</span><span id="__span-47-6"><span class="w">        </span>&lt;Directory<span class="w"> </span>/home/wwwroot/10&gt;
</span><span id="__span-47-7"><span class="w">        </span>AllowOverride<span class="w"> </span>None
</span><span id="__span-47-8"><span class="w">        </span>Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-47-9"><span class="w">        </span>&lt;/Directory&gt;
</span><span id="__span-47-10">&lt;/VirtualHost&gt;
</span><span id="__span-47-11">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.20&gt;
</span><span id="__span-47-12">DocumentRoot<span class="w"> </span>/home/wwwroot/20
</span><span id="__span-47-13">ServerName<span class="w"> </span>www.minayao20.com
</span><span id="__span-47-14">&lt;Directory<span class="w"> </span>/home/wwwroot/10&gt;
</span><span id="__span-47-15">AllowOverride<span class="w"> </span>None
</span><span id="__span-47-16">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-47-17">&lt;/Directory&gt;
</span><span id="__span-47-18">&lt;/VirtualHost&gt;
</span><span id="__span-47-19">
</span><span id="__span-47-20">
</span><span id="__span-47-21">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.30&gt;
</span><span id="__span-47-22">DocumentRoot<span class="w"> </span>/home/wwwroot/30
</span><span id="__span-47-23">ServerName<span class="w"> </span>www.minayao30.com
</span><span id="__span-47-24">&lt;Directory<span class="w"> </span>/home/wwwroot/10&gt;
</span><span id="__span-47-25">AllowOverride<span class="w"> </span>None
</span><span id="__span-47-26">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-47-27">&lt;/Directory&gt;
</span><span id="__span-47-28">&lt;/VirtualHost&gt;
</span><span id="__span-47-29">//权限设置
</span><span id="__span-47-30">DocumentRoot<span class="w"> </span><span class="s2">&quot;/home/wwwroot&quot;</span>
</span><span id="__span-47-31">
</span><span id="__span-47-32">
</span><span id="__span-47-33">&lt;Directory<span class="w"> </span><span class="s2">&quot;/home/wwwroot&quot;</span>&gt;
</span><span id="__span-47-34">AllowOverride<span class="w"> </span>None
</span><span id="__span-47-35"><span class="c1"># Allow open access:</span>
</span><span id="__span-47-36">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-47-37">&lt;/Directory&gt;
</span><span id="__span-47-38">
</span><span id="__span-47-39">
</span><span id="__span-47-40">Further<span class="w"> </span>relax<span class="w"> </span>access<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>document<span class="w"> </span>root:
</span><span id="__span-47-41">
</span><span id="__span-47-42">&lt;Directory<span class="w"> </span><span class="s2">&quot;/home/wwwroot&quot;</span>&gt;
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>基于主机域名</p>
</li>
<li>绑定IP和域名
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-48-1"><span class="c1">#编辑/etc/hosts</span>
</span><span id="__span-48-2"><span class="m">92</span>.168.10.10<span class="w">   </span>www.minayao10.com
</span><span id="__span-48-3"><span class="m">192</span>.168.10.20<span class="w">   </span>www.minayao20.com
</span><span id="__span-48-4"><span class="m">192</span>.168.10.30<span class="w">   </span>www.minayao30.com
</span></code></pre></div></td></tr></table></div></li>
<li>
<p>创建几个目录存放数据，并创建首页文件
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-49-1"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># mkdir -p /home/wwwroot/minayao10</span>
</span><span id="__span-49-2"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># mkdir -p /home/wwwroot/minayao20</span>
</span><span id="__span-49-3"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># mkdir -p /home/wwwroot/minayao30</span>
</span><span id="__span-49-4"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># echo www.minayao10.com &gt; minayao10/index.html</span>
</span><span id="__span-49-5"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># echo www.minayao20.com &gt; minayao20/index.html</span>
</span><span id="__span-49-6"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># echo www.minayao30.com &gt; minayao30/index.html</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>修改/etc/httpd/conf/httpd.conf
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-50-1">NameVirtualHost<span class="w"> </span>*:80
</span><span id="__span-50-2">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.10&gt;
</span><span id="__span-50-3"><span class="w">        </span>DocumentRoot<span class="w"> </span>/home/wwwroot/minayao10<span class="w">    </span>⬅here
</span><span id="__span-50-4"><span class="w">        </span>ServerName<span class="w"> </span>www.minayao10.com
</span><span id="__span-50-5"><span class="w">        </span>&lt;Directory<span class="w"> </span>/home/wwwroot/minayao10&gt;<span class="w">     </span>⬅
</span><span id="__span-50-6"><span class="w">        </span>AllowOverride<span class="w"> </span>None
</span><span id="__span-50-7"><span class="w">        </span>Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-50-8"><span class="w">        </span>&lt;/Directory&gt;
</span><span id="__span-50-9">&lt;/VirtualHost&gt;
</span><span id="__span-50-10">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.20&gt;
</span><span id="__span-50-11">DocumentRoot<span class="w"> </span>/home/wwwroot/minayao20<span class="w">   </span>⬅
</span><span id="__span-50-12">ServerName<span class="w"> </span>www.minayao20.com
</span><span id="__span-50-13">&lt;Directory<span class="w"> </span>/home/wwwroot/minayao10&gt;<span class="w">    </span>⬅
</span><span id="__span-50-14">AllowOverride<span class="w"> </span>None
</span><span id="__span-50-15">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-50-16">&lt;/Directory&gt;
</span><span id="__span-50-17">&lt;/VirtualHost&gt;
</span><span id="__span-50-18">
</span><span id="__span-50-19">
</span><span id="__span-50-20">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.30&gt;
</span><span id="__span-50-21">DocumentRoot<span class="w"> </span>/home/wwwroot/minayao30<span class="w">   </span>⬅
</span><span id="__span-50-22">ServerName<span class="w"> </span>www.minayao30.com
</span><span id="__span-50-23">&lt;Directory<span class="w"> </span>/home/wwwroot/minayao10&gt;<span class="w">    </span>⬅
</span><span id="__span-50-24">AllowOverride<span class="w"> </span>None
</span><span id="__span-50-25">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-50-26">&lt;/Directory&gt;
</span><span id="__span-50-27">&lt;/VirtualHost&gt;
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>如果没有设置selinux上下文的话要设置</p>
</li>
<li>
<p>基于端口号</p>
</li>
<li>创建目录
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-51-1"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># mkdir 6111</span>
</span><span id="__span-51-2"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># mkdir 6112</span>
</span><span id="__span-51-3"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># mkdir 6113</span>
</span></code></pre></div></td></tr></table></div></li>
<li>添加首页文件
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-52-1"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># echo &quot;port:6111&quot; &gt; 6111/index.html</span>
</span><span id="__span-52-2"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># echo &quot;port:6112&quot; &gt; 6112/index.html</span>
</span><span id="__span-52-3"><span class="o">[</span>root@192<span class="w"> </span>wwwroot<span class="o">]</span><span class="c1"># echo &quot;port:6113&quot; &gt; 6113/index.html</span>
</span></code></pre></div></td></tr></table></div></li>
<li>修改http.conf
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-53-1">Listen<span class="w"> </span><span class="m">6111</span>
</span><span id="__span-53-2">Listen<span class="w"> </span><span class="m">6112</span>
</span><span id="__span-53-3">Listen<span class="w"> </span><span class="m">6113</span>
</span><span id="__span-53-4">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.10:6111&gt;<span class="w">    </span>⬅here
</span><span id="__span-53-5">DocumentRoot<span class="w"> </span>/home/wwwroot/6111<span class="w">    </span>⬅here
</span><span id="__span-53-6">ServerName<span class="w"> </span>www.minayao10.com
</span><span id="__span-53-7">&lt;Directory<span class="w"> </span>/home/wwwroot/6111&gt;<span class="w">    </span>⬅here
</span><span id="__span-53-8">AllowOverride<span class="w"> </span>None
</span><span id="__span-53-9">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-53-10">&lt;/Directory&gt;
</span><span id="__span-53-11">&lt;/VirtualHost&gt;
</span><span id="__span-53-12">
</span><span id="__span-53-13">
</span><span id="__span-53-14">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.20:6112&gt;
</span><span id="__span-53-15">DocumentRoot<span class="w"> </span>/home/wwwroot/6112
</span><span id="__span-53-16">ServerName<span class="w"> </span>www.minayao20.com
</span><span id="__span-53-17">&lt;Directory<span class="w"> </span>/home/wwwroot/6112&gt;
</span><span id="__span-53-18">AllowOverride<span class="w"> </span>None
</span><span id="__span-53-19">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-53-20">&lt;/Directory&gt;
</span><span id="__span-53-21">&lt;/VirtualHost&gt;
</span><span id="__span-53-22">
</span><span id="__span-53-23">
</span><span id="__span-53-24">&lt;VirtualHost<span class="w"> </span><span class="m">192</span>.168.10.30:6113&gt;
</span><span id="__span-53-25">DocumentRoot<span class="w"> </span>/home/wwwroot/6113
</span><span id="__span-53-26">ServerName<span class="w"> </span>www.minayao30.com
</span><span id="__span-53-27">&lt;Directory<span class="w"> </span>/home/wwwroot/6113&gt;
</span><span id="__span-53-28">AllowOverride<span class="w"> </span>None
</span><span id="__span-53-29">Require<span class="w"> </span>all<span class="w"> </span>granted
</span><span id="__span-53-30">&lt;/Directory&gt;
</span><span id="__span-53-31">&lt;/VirtualHost&gt;
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="apache">apache的访问控制<a class="headerlink" href="#apache" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>创建目录server，并创建首页文件</p>
</li>
<li>
<p>编辑httpd.conf
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-54-1">限制浏览器登录
</span><span id="__span-54-2">&lt;Directory<span class="w"> </span><span class="s2">&quot;/home/wwwroot/server&quot;</span>&gt;
</span><span id="__span-54-3"><span class="w">        </span>SetEnvIf<span class="w"> </span>User-Agent<span class="w"> </span><span class="s2">&quot;Firefox&quot;</span><span class="w"> </span><span class="nv">ff</span><span class="o">=</span><span class="m">1</span>
</span><span id="__span-54-4"><span class="w">        </span>Order<span class="w"> </span>allow,deny
</span><span id="__span-54-5"><span class="w">        </span>Allow<span class="w"> </span>from<span class="w"> </span><span class="nv">env</span><span class="o">=</span>ff
</span><span id="__span-54-6">&lt;/Directory&gt;
</span></code></pre></div></td></tr></table></div>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-55-1">限制IP地址
</span><span id="__span-55-2">&lt;Directory<span class="w"> </span><span class="s2">&quot;/home/wwwroot/server&quot;</span>&gt;
</span><span id="__span-55-3"><span class="w">        </span>Order<span class="w"> </span>allow,deny
</span><span id="__span-55-4"><span class="w">        </span>Allow<span class="w"> </span>from<span class="w"> </span><span class="m">192</span>.168.10.10
</span><span id="__span-55-5">&lt;/Directory&gt;
</span></code></pre></div></td></tr></table></div></p>
</li>
</ol>
<blockquote>
<p>想要查询并过滤http协议相关的selinux域策略有哪些？
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-56-1">*<span class="w"> </span>getsebool<span class="w"> </span>-a<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>http
</span></code></pre></div></td></tr></table></div>
使用端口号配置虚拟主机网站有什么特点</p>
</blockquote>
<p>在使用端口号来配置虚拟主机网站时，必须要考虑到SELinux域对httpd服务程序所用端口号的控制策略，还要在httpd服务程序的主配置文件中使用Listen参数来开启要监听的端口号。</p>
<h2 id="7vsftpd">7.使用vsftpd服务传输文件<a class="headerlink" href="#7vsftpd" title="Permanent link">&para;</a></h2>
<h3 id="_28">文件传输协议<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-57-1">ftp是一种在互联网中进行文件传输的协议，基于C/S模式，默认使用20、21端口，20用来进行数据传输，21用于接收客户端发出的命令和参数
</span><span id="__span-57-2">
</span><span id="__span-57-3">ftp协议有两种工作模式
</span><span id="__span-57-4">
</span><span id="__span-57-5">主动模式：FTP服务器主动向客户端发起连接请求。
</span><span id="__span-57-6">
</span><span id="__span-57-7">被动模式：FTP服务器等待客户端发起连接请求（默认工作模式）。
</span></code></pre></div></td></tr></table></div>
<h3 id="vsftpd">vsftpd服务程序<a class="headerlink" href="#vsftpd" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>vsftpd的主配置文件/etc/vsftpd/vsftpd.conf</p>
</li>
<li>
<p>表11-1 vsftpd服务程序常用的参数以及作用</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>listen=[YES</td>
<td>NO]</td>
</tr>
<tr>
<td>listen_address=IP地址</td>
<td>设置要监听的IP地址</td>
</tr>
<tr>
<td>listen_port=21</td>
<td>设置FTP服务的监听端口</td>
</tr>
<tr>
<td>download_enable＝[YES</td>
<td>NO]</td>
</tr>
<tr>
<td>userlist_enable=[YES</td>
<td>NO] userlist_deny=[YES</td>
</tr>
<tr>
<td>max_clients=0</td>
<td>最大客户端连接数，0为不限制</td>
</tr>
<tr>
<td>max_per_ip=0</td>
<td>同一IP地址的最大连接数，0为不限制</td>
</tr>
<tr>
<td>anonymous_enable=[YES</td>
<td>NO]</td>
</tr>
<tr>
<td>anon_upload_enable=[YES</td>
<td>NO]</td>
</tr>
<tr>
<td>anon_umask=022</td>
<td>匿名用户上传文件的umask值</td>
</tr>
<tr>
<td>anon_root=/var/ftp</td>
<td>匿名用户的FTP根目录</td>
</tr>
<tr>
<td>anon_mkdir_write_enable=[YES</td>
<td>NO]</td>
</tr>
<tr>
<td>anon_other_write_enable=[YES</td>
<td>NO]</td>
</tr>
<tr>
<td>anon_max_rate=0</td>
<td>匿名用户的最大传输速率（字节/秒），0为不限制</td>
</tr>
<tr>
<td>local_enable=[YES</td>
<td>NO]</td>
</tr>
<tr>
<td>local_umask=022</td>
<td>本地用户上传文件的umask值</td>
</tr>
<tr>
<td>local_root=/var/ftp</td>
<td>本地用户的FTP根目录</td>
</tr>
<tr>
<td>chroot_local_user=[YES</td>
<td>NO]</td>
</tr>
<tr>
<td>local_max_rate=0</td>
<td>本地用户最大传输速率（字节/秒），0为不限制</td>
</tr>
</tbody>
</table>
<ul>
<li>vsftpd的三种认证模式
        1. 匿名开放模式：是最不安全的一种认证模式，任何人都可以无须密码验证而直接登录到FTP服务器。
        2. 本地用户模式：是通过Linux系统本地的账户密码信息进行认证的模式，相较于匿名开放模式更安全，而且配置起来也很简单。但是如果黑客破解了账户的信息，就可以畅通无阻地登录FTP服务器，从而完全控制整台服务器。
        3. 虚拟用户模式：更安全的一种认证模式，它需要为FTP服务单独建立用户数据库文件，虚拟出用来进行密码验证的账户信息，而这些账户信息在服务器系统中实际上是不存在的，仅供FTP服务程序进行认证使用。这样，即使黑客破解了账户信息也无法登录服务器，从而有效降低了破坏范围和影响。</li>
<li>
<p>ftp客户端</p>
</li>
<li>
<p>匿名开放模式</p>
</li>
<li>表11-2 向匿名用户开放的权限参数以及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>anonymous_enable=YES</td>
<td>允许匿名访问模式</td>
</tr>
<tr>
<td>anon_umask=022</td>
<td>匿名用户上传文件的umask值</td>
</tr>
<tr>
<td>anon_upload_enable=YES</td>
<td>允许匿名用户上传文件</td>
</tr>
<tr>
<td>anon_mkdir_write_enable=YES</td>
<td>允许匿名用户创建目录</td>
</tr>
<tr>
<td>anon_other_write_enable=YES</td>
<td>允许匿名用户修改目录名称或删除目录</td>
</tr>
</tbody>
</table>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-58-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/vsftpd/vsftpd.conf</span>
</span><span id="__span-58-2"><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="nv">anonymous_enable</span><span class="o">=</span>YES
</span><span id="__span-58-3"><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="nv">anon_umask</span><span class="o">=</span><span class="m">022</span>
</span><span id="__span-58-4"><span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="nv">anon_upload_enable</span><span class="o">=</span>YES
</span><span id="__span-58-5"><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="nv">anon_mkdir_write_enable</span><span class="o">=</span>YES
</span><span id="__span-58-6"><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="nv">anon_other_write_enable</span><span class="o">=</span>YES
</span><span id="__span-58-7"><span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="nv">local_enable</span><span class="o">=</span>YES
</span><span id="__span-58-8"><span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="nv">write_enable</span><span class="o">=</span>YES
</span><span id="__span-58-9"><span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="nv">local_umask</span><span class="o">=</span><span class="m">022</span>
</span><span id="__span-58-10"><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="nv">dirmessage_enable</span><span class="o">=</span>YES
</span><span id="__span-58-11"><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="nv">xferlog_enable</span><span class="o">=</span>YES
</span><span id="__span-58-12"><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="nv">connect_from_port_20</span><span class="o">=</span>YES
</span><span id="__span-58-13"><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="nv">xferlog_std_format</span><span class="o">=</span>YES
</span><span id="__span-58-14"><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="nv">listen</span><span class="o">=</span>NO
</span><span id="__span-58-15"><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="nv">listen_ipv6</span><span class="o">=</span>YES
</span><span id="__span-58-16"><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="nv">pam_service_name</span><span class="o">=</span>vsftpd
</span><span id="__span-58-17"><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="nv">userlist_enable</span><span class="o">=</span>YES
</span><span id="__span-58-18"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart vsftpd</span>
</span><span id="__span-58-19"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable vsftpd</span>
</span><span id="__span-58-20"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># setsebool -P ftpd_full_access=on</span>
</span></code></pre></div></td></tr></table></div>
<ul>
<li>本地用户模式</li>
<li>表11-3 本地用户模式使用的权限参数以及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>anonymous_enable=NO</td>
<td>禁止匿名访问模式</td>
</tr>
<tr>
<td>local_enable=YES</td>
<td>允许本地用户模式</td>
</tr>
<tr>
<td>write_enable=YES</td>
<td>设置可写权限</td>
</tr>
<tr>
<td>local_umask=022</td>
<td>本地用户模式创建文件的umask值</td>
</tr>
<tr>
<td>userlist_deny=YES</td>
<td>启用“禁止用户名单”，名单文件为ftpusers和user_list</td>
</tr>
<tr>
<td>userlist_enable=YES</td>
<td>开启用户作用名单文件功能</td>
</tr>
<tr>
<td><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-59-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/vsftpd/vsftpd.conf</span>
</span><span id="__span-59-2"><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="nv">anonymous_enable</span><span class="o">=</span>NO
</span><span id="__span-59-3"><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="nv">local_enable</span><span class="o">=</span>YES
</span><span id="__span-59-4"><span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="nv">write_enable</span><span class="o">=</span>YES
</span><span id="__span-59-5"><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="nv">local_umask</span><span class="o">=</span><span class="m">022</span>
</span><span id="__span-59-6"><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="nv">dirmessage_enable</span><span class="o">=</span>YES
</span><span id="__span-59-7"><span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="nv">xferlog_enable</span><span class="o">=</span>YES
</span><span id="__span-59-8"><span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="nv">connect_from_port_20</span><span class="o">=</span>YES
</span><span id="__span-59-9"><span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="nv">xferlog_std_format</span><span class="o">=</span>YES
</span><span id="__span-59-10"><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="nv">listen</span><span class="o">=</span>NO
</span><span id="__span-59-11"><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="nv">listen_ipv6</span><span class="o">=</span>YES
</span><span id="__span-59-12"><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="nv">pam_service_name</span><span class="o">=</span>vsftpd
</span><span id="__span-59-13"><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="nv">userlist_enable</span><span class="o">=</span>YES
</span><span id="__span-59-14"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart vsftpd</span>
</span><span id="__span-59-15"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable vsftpd</span>
</span><span id="__span-59-16"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># cat /etc/vsftpd/user_list </span>
</span><span id="__span-59-17"><span class="c1">#root  黑名单模式（默认userlist_deny=yes）下将要登陆的账号注释掉才能登录成功</span>
</span><span id="__span-59-18"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># cat /etc/vsftpd/ftpusers </span>
</span><span id="__span-59-19"><span class="c1">#root</span>
</span><span id="__span-59-20"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># ftp 192.168.10.10</span>
</span><span id="__span-59-21">Connected<span class="w"> </span>to<span class="w"> </span><span class="m">192</span>.168.10.10<span class="w"> </span><span class="o">(</span><span class="m">192</span>.168.10.10<span class="o">)</span>.
</span><span id="__span-59-22"><span class="m">220</span><span class="w"> </span><span class="o">(</span>vsFTPd<span class="w"> </span><span class="m">3</span>.0.3<span class="o">)</span>
</span><span id="__span-59-23">Name<span class="w"> </span><span class="o">(</span><span class="m">192</span>.168.10.10:root<span class="o">)</span>:<span class="w"> </span>root
</span><span id="__span-59-24"><span class="m">331</span><span class="w"> </span>Please<span class="w"> </span>specify<span class="w"> </span>the<span class="w"> </span>password.
</span><span id="__span-59-25">Password:此处输入该用户的密码
</span><span id="__span-59-26"><span class="m">230</span><span class="w"> </span>Login<span class="w"> </span>successful.
</span><span id="__span-59-27">Remote<span class="w"> </span>system<span class="w"> </span><span class="nb">type</span><span class="w"> </span>is<span class="w"> </span>UNIX.
</span><span id="__span-59-28">Using<span class="w"> </span>binary<span class="w"> </span>mode<span class="w"> </span>to<span class="w"> </span>transfer<span class="w"> </span>files.
</span><span id="__span-59-29">ftp&gt;
</span></code></pre></div></td></tr></table></div></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>虚拟用户模式</li>
<li>重新安装vsftpd服务。创建用于进行FTP认证的用户数据库文件，其中奇数行为账户名，偶数行为密码。例如，分别创建zhangsan和lisi两个用户，密码均为redhat：
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-60-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># cd /etc/vsftpd/</span>
</span><span id="__span-60-2"><span class="o">[</span>root@linuxprobe<span class="w"> </span>vsftpd<span class="o">]</span><span class="c1"># vim vuser.list</span>
</span><span id="__span-60-3">zhangsan
</span><span id="__span-60-4">redhat
</span><span id="__span-60-5">lisi
</span><span id="__span-60-6">redhat
</span></code></pre></div></td></tr></table></div>
由于明文信息既不安全，也不符合让vsftpd服务程序直接加载的格式，因此需要使用db_load命令用哈希（hash）算法将原始的明文信息文件转换成数据库文件，并且降低数据库文件的权限（避免其他人看到数据库文件的内容），然后再把原始的明文信息文件删除。
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-61-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>vsftpd<span class="o">]</span><span class="c1"># db_load -T -t hash -f vuser.list vuser.db</span>
</span><span id="__span-61-2"><span class="o">[</span>root@linuxprobe<span class="w"> </span>vsftpd<span class="o">]</span><span class="c1"># chmod 600 vuser.db</span>
</span><span id="__span-61-3"><span class="o">[</span>root@linuxprobe<span class="w"> </span>vsftpd<span class="o">]</span><span class="c1"># rm -f vuser.list</span>
</span></code></pre></div></td></tr></table></div></li>
<li>创建vsftpd服务程序用于存储文件的根目录以及用于虚拟用户映射的系统本地用户。vsftpd服务用于存储文件的根目录指的是，当虚拟用户登录后所访问的默认位置。
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-62-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># useradd -d /var/ftproot -s /sbin/nologin virtual</span>
</span><span id="__span-62-2"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># ls -ld /var/ftproot/</span>
</span><span id="__span-62-3">drwx------.<span class="w"> </span><span class="m">3</span><span class="w"> </span>virtual<span class="w"> </span>virtual<span class="w"> </span><span class="m">74</span><span class="w"> </span>Jul<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">17</span>:50<span class="w"> </span>/var/ftproot/
</span><span id="__span-62-4"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># chmod -Rf 755 /var/ftproot/</span>
</span></code></pre></div></td></tr></table></div></li>
<li>建立用于支持虚拟用户的PAM文件。</li>
</ul>
<p>新建一个用于虚拟用户认证的PAM文件vsftpd.vu，其中PAM文件内的“db=”参数为使用db_load命令生成的账户密码数据库文件的路径，但不用写数据库文件的后缀：
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-63-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/pam.d/vsftpd.vu</span>
</span><span id="__span-63-2">auth<span class="w">       </span>required<span class="w">     </span>pam_userdb.so<span class="w"> </span><span class="nv">db</span><span class="o">=</span>/etc/vsftpd/vuser
</span><span id="__span-63-3">account<span class="w">    </span>required<span class="w">     </span>pam_userdb.so<span class="w"> </span><span class="nv">db</span><span class="o">=</span>/etc/vsftpd/vuser
</span></code></pre></div></td></tr></table></div>
  4. 在vsftpd服务程序的主配置文件中通过pam_service_name参数将PAM认证文件的名称修改为vsftpd.vu。PAM作为应用程序层与鉴别模块层的连接纽带，可以让应用程序根据需求灵活地在自身插入所需的鉴别功能模块。当应用程序需要PAM认证时，则需要在应用程序中定义负责认证的PAM配置文件，实现所需的认证功能。
   例如，在vsftpd服务程序的主配置文件中默认就带有参数pam_service_name=vsftpd，表示登录FTP服务器时是根据/etc/pam.d/vsftpd文件进行安全认证的。现在我们要做的就是把vsftpd主配置文件中原有的PAM认证文件vsftpd修改为新建的vsftpd.vu文件即可。该操作中用到的参数以及作用如表11-4所示。</p>
<ul>
<li>表11-4 利用PAM文件进行认证时使用的参数以及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>anonymous_enable=NO</td>
<td>禁止匿名开放模式</td>
</tr>
<tr>
<td>local_enable=YES</td>
<td>允许本地用户模式</td>
</tr>
<tr>
<td>guest_enable=YES</td>
<td>开启虚拟用户模式</td>
</tr>
<tr>
<td>guest_username=virtual</td>
<td>指定虚拟用户账户</td>
</tr>
<tr>
<td>pam_service_name=vsftpd.vu</td>
<td>指定PAM文件</td>
</tr>
<tr>
<td>allow_writeable_chroot=YES</td>
<td>允许对禁锢的FTP根目录执行写入操作，而且不拒绝用户的登录请求</td>
</tr>
<tr>
<td><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-64-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/vsftpd/vsftpd.conf  </span>
</span><span id="__span-64-2"><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="nv">anonymous_enable</span><span class="o">=</span>NO
</span><span id="__span-64-3"><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="nv">local_enable</span><span class="o">=</span>YES
</span><span id="__span-64-4"><span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="nv">write_enable</span><span class="o">=</span>YES
</span><span id="__span-64-5"><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="nv">guest_enable</span><span class="o">=</span>YES
</span><span id="__span-64-6"><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="nv">guest_username</span><span class="o">=</span>virtual
</span><span id="__span-64-7"><span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="nv">allow_writeable_chroot</span><span class="o">=</span>YES
</span><span id="__span-64-8"><span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="nv">local_umask</span><span class="o">=</span><span class="m">022</span>
</span><span id="__span-64-9"><span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="nv">dirmessage_enable</span><span class="o">=</span>YES
</span><span id="__span-64-10"><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="nv">xferlog_enable</span><span class="o">=</span>YES
</span><span id="__span-64-11"><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="nv">connect_from_port_20</span><span class="o">=</span>YES
</span><span id="__span-64-12"><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="nv">xferlog_std_format</span><span class="o">=</span>YES
</span><span id="__span-64-13"><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="nv">listen</span><span class="o">=</span>NO
</span><span id="__span-64-14"><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="nv">listen_ipv6</span><span class="o">=</span>YES
</span><span id="__span-64-15"><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="nv">pam_service_name</span><span class="o">=</span>vsftpd.vu
</span><span id="__span-64-16"><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="nv">userlist_enable</span><span class="o">=</span>YES
</span></code></pre></div></td></tr></table></div></td>
<td></td>
</tr>
</tbody>
</table>
<ol>
<li>为虚拟用户设置不同的权限。虽然账户zhangsan和lisi都是用于vsftpd服务程序认证的虚拟账户，但是我们依然想对这两人进行区别对待。比如，允许张三上传、创建、修改、查看、删除文件，只允许李四查看文件。这可以通过vsftpd服务程序来实现。只需新建一个目录，在里面分别创建两个以zhangsan和lisi命名的文件，其中在名为zhangsan的文件中写入允许的相关权限（使用匿名用户的参数）：
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-65-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># mkdir /etc/vsftpd/vusers_dir/</span>
</span><span id="__span-65-2"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># cd /etc/vsftpd/vusers_dir/</span>
</span><span id="__span-65-3"><span class="o">[</span>root@linuxprobe<span class="w"> </span>vusers_dir<span class="o">]</span><span class="c1"># touch lisi</span>
</span><span id="__span-65-4"><span class="o">[</span>root@linuxprobe<span class="w"> </span>vusers_dir<span class="o">]</span><span class="c1"># vim zhangsan</span>
</span><span id="__span-65-5"><span class="nv">anon_upload_enable</span><span class="o">=</span>YES
</span><span id="__span-65-6"><span class="nv">anon_mkdir_write_enable</span><span class="o">=</span>YES
</span><span id="__span-65-7"><span class="nv">anon_other_write_enable</span><span class="o">=</span>YES
</span></code></pre></div></td></tr></table></div></li>
</ol>
<p>然后再次修改vsftpd主配置文件，通过添加user_config_dir参数来定义这两个虚拟用户不同权限的配置文件所存放的路径。为了让修改后的参数立即生效，需要重启vsftpd服务程序并将该服务添加到开机启动项中：</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-66-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/vsftpd/vsftpd.conf</span>
</span><span id="__span-66-2"><span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="nv">anonymous_enable</span><span class="o">=</span>NO
</span><span id="__span-66-3"><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="nv">local_enable</span><span class="o">=</span>YES
</span><span id="__span-66-4"><span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="nv">write_enable</span><span class="o">=</span>YES
</span><span id="__span-66-5"><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="nv">guest_enable</span><span class="o">=</span>YES
</span><span id="__span-66-6"><span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="nv">guest_username</span><span class="o">=</span>virtual
</span><span id="__span-66-7"><span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="nv">allow_writeable_chroot</span><span class="o">=</span>YES
</span><span id="__span-66-8"><span class="w">  </span><span class="m">7</span><span class="w"> </span><span class="nv">local_umask</span><span class="o">=</span><span class="m">022</span>
</span><span id="__span-66-9"><span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="nv">dirmessage_enable</span><span class="o">=</span>YES
</span><span id="__span-66-10"><span class="w">  </span><span class="m">9</span><span class="w"> </span><span class="nv">xferlog_enable</span><span class="o">=</span>YES
</span><span id="__span-66-11"><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="nv">connect_from_port_20</span><span class="o">=</span>YES
</span><span id="__span-66-12"><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="nv">xferlog_std_format</span><span class="o">=</span>YES
</span><span id="__span-66-13"><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="nv">listen</span><span class="o">=</span>NO
</span><span id="__span-66-14"><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="nv">listen_ipv6</span><span class="o">=</span>YES
</span><span id="__span-66-15"><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="nv">pam_service_name</span><span class="o">=</span>vsftpd.vu
</span><span id="__span-66-16"><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="nv">userlist_enable</span><span class="o">=</span>YES
</span><span id="__span-66-17"><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="nv">user_config_dir</span><span class="o">=</span>/etc/vsftpd/vusers_dir<span class="w">     </span>⬅<span class="w">   </span>here
</span><span id="__span-66-18"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart vsftpd</span>
</span><span id="__span-66-19"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable vsftpd</span>
</span><span id="__span-66-20">Created<span class="w"> </span>symlink<span class="w"> </span>/etc/systemd/system/multi-user.target.wants/vsftpd.service<span class="w"> </span>→<span class="w"> </span>/usr/lib/systemd/system/vsftpd.service.
</span><span id="__span-66-21"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># setsebool -P ftpd_full_access=on</span>
</span></code></pre></div></td></tr></table></div>
<p>使用不同的方式登录文件传输服务器后，默认所在的位置，如表11-5所示。</p>
<ul>
<li>表11-5 vsftpd服务程序登陆后所在目录</li>
</ul>
<table>
<thead>
<tr>
<th>登录方式</th>
<th>默认目录</th>
</tr>
</thead>
<tbody>
<tr>
<td>匿名公开</td>
<td>/var/ftp</td>
</tr>
<tr>
<td>本地用户</td>
<td>该用户的家目录</td>
</tr>
<tr>
<td>虚拟用户</td>
<td>对应映射用户的家目录</td>
</tr>
</tbody>
</table>
<h3 id="tftp">TFTP简单文件传输协议<a class="headerlink" href="#tftp" title="Permanent link">&para;</a></h3>
<p>因为TFTP不需要客户端的权限认证，也就减少了无谓的系统和网络带宽消耗，因此在传输琐碎（trivial）不大的文件时，效率更高。tftp-server是服务程序，tftp是用于连接测试的客户端工具，xinetd是管理服务</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-67-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># dnf install tftp-server tftp xinetd</span>
</span><span id="__span-67-2"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/xinetd.d/tftp</span>
</span><span id="__span-67-3">service<span class="w"> </span>tftp
</span><span id="__span-67-4"><span class="o">{</span>
</span><span id="__span-67-5"><span class="w">        </span><span class="nv">socket_type</span><span class="w">             </span><span class="o">=</span><span class="w"> </span>dgram
</span><span id="__span-67-6"><span class="w">        </span><span class="nv">protocol</span><span class="w">                </span><span class="o">=</span><span class="w"> </span>udp
</span><span id="__span-67-7"><span class="w">        </span><span class="nb">wait</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span>yes
</span><span id="__span-67-8"><span class="w">        </span><span class="nv">user</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span>root
</span><span id="__span-67-9"><span class="w">        </span><span class="nv">server</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span>/usr/sbin/in.tftpd
</span><span id="__span-67-10"><span class="w">        </span><span class="nv">server_args</span><span class="w">             </span><span class="o">=</span><span class="w"> </span>-s<span class="w"> </span>/var/lib/tftpboot
</span><span id="__span-67-11"><span class="w">        </span><span class="nv">disable</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span>no
</span><span id="__span-67-12"><span class="w">        </span><span class="nv">per_source</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="m">11</span>
</span><span id="__span-67-13"><span class="w">        </span><span class="nv">cps</span><span class="w">                     </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">2</span>
</span><span id="__span-67-14"><span class="w">        </span><span class="nv">flags</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span>IPv4
</span><span id="__span-67-15"><span class="o">}</span>
</span><span id="__span-67-16"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart tftp</span>
</span><span id="__span-67-17"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable tftp</span>
</span><span id="__span-67-18"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart xinetd</span>
</span><span id="__span-67-19"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable xinetd</span>
</span><span id="__span-67-20"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --zone=public --permanent --add-port=69/udp</span>
</span><span id="__span-67-21">success
</span><span id="__span-67-22"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --reload </span>
</span><span id="__span-67-23">success
</span></code></pre></div></td></tr></table></div>
<ul>
<li>表11-6 tftp命令中可用的参数以及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>帮助信息</td>
</tr>
<tr>
<td>put</td>
<td>上传文件</td>
</tr>
<tr>
<td>get</td>
<td>下载文件</td>
</tr>
<tr>
<td>verbose</td>
<td>显示详细的处理信息</td>
</tr>
<tr>
<td>status</td>
<td>显示当前的状态信息</td>
</tr>
<tr>
<td>binary</td>
<td>使用二进制进行传输</td>
</tr>
<tr>
<td>ascii</td>
<td>使用ASCII码进行传输</td>
</tr>
<tr>
<td>timeout</td>
<td>设置重传的超时时间</td>
</tr>
<tr>
<td>quit</td>
<td>退出</td>
</tr>
</tbody>
</table>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-68-1"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># echo &quot;i love linux&quot; &gt; /var/lib/tftpboot/readme.txt</span>
</span><span id="__span-68-2"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># tftp 192.168.10.10</span>
</span><span id="__span-68-3">tftp&gt;<span class="w"> </span>get<span class="w"> </span>readme.txt
</span><span id="__span-68-4">tftp&gt;<span class="w"> </span>quit
</span><span id="__span-68-5"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># ls</span>
</span><span id="__span-68-6">anaconda-ks.cfg<span class="w">  </span>Documents<span class="w">  </span>initial-setup-ks.cfg<span class="w">  </span>Pictures<span class="w">  </span>readme.txt<span class="w">  </span>Videos
</span><span id="__span-68-7">Desktop<span class="w">          </span>Downloads<span class="w">  </span>Music<span class="w">                 </span>Public<span class="w">    </span>Templates
</span><span id="__span-68-8"><span class="o">[</span>root@linuxprobe<span class="w"> </span>~<span class="o">]</span><span class="c1"># cat readme.txt </span>
</span><span id="__span-68-9">i<span class="w"> </span>love<span class="w"> </span>linux
</span></code></pre></div></td></tr></table></div>
<h2 id="8sambanfs">8.使用samba/NFS实现文件共享<a class="headerlink" href="#8sambanfs" title="Permanent link">&para;</a></h2>
<h3 id="samba">samba文件共享服务<a class="headerlink" href="#samba" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>安装samba服务程序
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-69-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># yum -y install samba samba-client</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>配置文件/etc/samba/smb.conf</p>
</li>
<li>
<p>表12-1 Samba服务程序中的参数以及作用</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>行数</th>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td># See smb.conf.example for a more detailed config file or</td>
<td>注释信息</td>
</tr>
<tr>
<td>2</td>
<td># read the smb.conf manpage.</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td># Run 'testparm' to verify the config is correct after</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td># you modified it.</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>[global]</td>
<td>全局参数</td>
</tr>
<tr>
<td>6</td>
<td>workgroup = SAMBA</td>
<td>工作组名称</td>
</tr>
<tr>
<td>7</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>security = user</td>
<td>安全验证的方式，总共有4种</td>
</tr>
<tr>
<td>9</td>
<td></td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>passdb backend = tdbsam</td>
<td>定义用户后台的类型，总共有3种</td>
</tr>
<tr>
<td>11</td>
<td></td>
<td></td>
</tr>
<tr>
<td>12</td>
<td>printing = cups</td>
<td>打印服务协议</td>
</tr>
<tr>
<td>13</td>
<td>printcap name = cups</td>
<td>打印服务名称</td>
</tr>
<tr>
<td>14</td>
<td>load printers = yes</td>
<td>是否加载打印机</td>
</tr>
<tr>
<td>15</td>
<td>cups options = raw</td>
<td>打印机的选项</td>
</tr>
<tr>
<td>16</td>
<td></td>
<td></td>
</tr>
<tr>
<td>17</td>
<td>[homes]</td>
<td>共享名称</td>
</tr>
<tr>
<td>18</td>
<td>comment = Home Directories</td>
<td>描述信息</td>
</tr>
<tr>
<td>19</td>
<td>valid users = %S, %D%w%S</td>
<td>可用账户</td>
</tr>
<tr>
<td>20</td>
<td>browseable = No</td>
<td>指定共享信息是否在“网上邻居”中可见</td>
</tr>
<tr>
<td>21</td>
<td>read only = No</td>
<td>是否只读</td>
</tr>
<tr>
<td>22</td>
<td>inherit acls = Yes</td>
<td>是否继承访问控制列表</td>
</tr>
<tr>
<td>23</td>
<td></td>
<td></td>
</tr>
<tr>
<td>24</td>
<td>[printers] 共享名称</td>
<td></td>
</tr>
<tr>
<td>25</td>
<td>comment = All Printers</td>
<td>描述信息</td>
</tr>
<tr>
<td>26</td>
<td>path = /var/tmp</td>
<td>共享路径</td>
</tr>
<tr>
<td>27</td>
<td>printable = Yes</td>
<td>是否可打印</td>
</tr>
<tr>
<td>28</td>
<td>create mask = 0600</td>
<td>文件权限</td>
</tr>
<tr>
<td>29</td>
<td>browseable = No</td>
<td>指定共享信息是否在“网上邻居”中可见</td>
</tr>
<tr>
<td>30</td>
<td></td>
<td></td>
</tr>
<tr>
<td>31</td>
<td>[print$]   共享名称</td>
<td></td>
</tr>
<tr>
<td>32</td>
<td>comment = Printer Drivers</td>
<td>描述信息</td>
</tr>
<tr>
<td>33</td>
<td>path = /var/lib/samba/drivers</td>
<td>共享路径</td>
</tr>
<tr>
<td>34</td>
<td>write list = @printadmin root</td>
<td>可写入文件的用户列表</td>
</tr>
<tr>
<td>35</td>
<td>force group = @printadmin</td>
<td>用户组列表</td>
</tr>
<tr>
<td>36</td>
<td>create mask = 0664</td>
<td>文件权限</td>
</tr>
<tr>
<td>37</td>
<td>directory mask = 0775</td>
<td>目录权限</td>
</tr>
</tbody>
</table>
<p>在上面的代码中，security参数代表用户登录Samba服务时采用的验证方式。总共有4种可用参数。</p>
<blockquote>
<p>share：代表主机无须验证密码。这相当于vsftpd服务的匿名公开访问模式，比较方便，但安全性很差。</p>
<p>user：代表登录Samba服务时需要使用账号密码进行验证，通过后才能获取到文件。这是默认的验证方式，最为常用。</p>
<p>domain：代表通过域控制器进行身份验证，用来限制用户的来源域。</p>
<p>server：代表使用独立主机验证来访用户提供的密码。这相当于集中管理账号，并不常用。 </p>
</blockquote>
<ul>
<li>
<p>配置共享</p>
</li>
<li>
<p>表12-2 用于设置Samba服务程序的参数以及作用</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>[database]</td>
<td>共享名称为database</td>
</tr>
<tr>
<td>comment = Do not arbitrarily modify the database file</td>
<td>警告用户不要随意修改数据库</td>
</tr>
<tr>
<td>path = /home/database</td>
<td>共享目录为/home/database</td>
</tr>
<tr>
<td>public = no</td>
<td>关闭“所有人可见”</td>
</tr>
<tr>
<td>writable = yes</td>
<td>允许写入操作</td>
</tr>
</tbody>
</table>
<ol>
<li>配置
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-70-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># pdbedit -a -u minayao</span>
</span><span id="__span-70-2"><span class="c1">#创建共享账户（账户需要是本地存在的用户）</span>
</span><span id="__span-70-3"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># mkdir /home/database</span>
</span><span id="__span-70-4"><span class="c1">#创建共享资源的文件目录</span>
</span><span id="__span-70-5"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># chown -Rf minayao:minayao /home/database</span>
</span><span id="__span-70-6"><span class="c1">#改权限</span>
</span><span id="__span-70-7"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># semanage fcontext -a -t samba_share_t /home/database</span>
</span><span id="__span-70-8"><span class="c1">#改安全上下文</span>
</span><span id="__span-70-9"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># restorecon -Rv /home/database</span>
</span><span id="__span-70-10"><span class="c1">#让安全上下文立即生效</span>
</span><span id="__span-70-11"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># setsebool -P samba_enable_home_dirs on</span>
</span><span id="__span-70-12"><span class="c1">#更改selinux域策略放行家目录共享</span>
</span><span id="__span-70-13"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/samba/smb.conf</span>
</span><span id="__span-70-14"><span class="o">[</span>global<span class="o">]</span>
</span><span id="__span-70-15"><span class="w">        </span><span class="nv">workgroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SAMBA
</span><span id="__span-70-16"><span class="w">        </span><span class="nv">security</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>user
</span><span id="__span-70-17"><span class="w">        </span>passdb<span class="w"> </span><span class="nv">backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>tdbsam
</span><span id="__span-70-18"><span class="o">[</span>database<span class="o">]</span>
</span><span id="__span-70-19"><span class="w">        </span><span class="nv">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Do<span class="w"> </span>not<span class="w"> </span>arbitrarily<span class="w"> </span>modify<span class="w"> </span>the<span class="w"> </span>database<span class="w"> </span>file
</span><span id="__span-70-20"><span class="w">        </span><span class="nv">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/home/database
</span><span id="__span-70-21"><span class="w">        </span><span class="nv">public</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>no
</span><span id="__span-70-22"><span class="w">        </span><span class="nv">writable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes
</span><span id="__span-70-23"><span class="c1">#修改配置文件，最后重启服务</span>
</span><span id="__span-70-24"><span class="se">\\</span><span class="m">192</span>.168.10.10<span class="w">   </span>windos挂载共享
</span><span id="__span-70-25"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># smbclient -U minayao -L 192.168.10.10</span>
</span><span id="__span-70-26"><span class="c1">#查看当前共享了哪些文件</span>
</span></code></pre></div></td></tr></table></div></li>
<li>
<p>挂载 
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-71-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># yum -y install cifs-utils</span>
</span><span id="__span-71-2"><span class="c1">#Linux支持文件共享的软件包</span>
</span><span id="__span-71-3"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># mkdir /database</span>
</span><span id="__span-71-4"><span class="c1">#创建挂载点</span>
</span><span id="__span-71-5"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># mount -t cifs -o username=minayao,password=aaaa //192.168.10.10/database /database</span>
</span><span id="__span-71-6"><span class="c1">#挂载</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>自动加载共享
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-72-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim auth.smb</span>
</span><span id="__span-72-2"><span class="nv">username</span><span class="o">=</span>minayao
</span><span id="__span-72-3"><span class="nv">password</span><span class="o">=</span>aaaa
</span><span id="__span-72-4"><span class="nv">domain</span><span class="o">=</span>MYGROUP
</span><span id="__span-72-5"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># chmod 600 auth.smb</span>
</span><span id="__span-72-6">
</span><span id="__span-72-7">
</span><span id="__span-72-8"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/fstab</span>
</span><span id="__span-72-9">//192.168.10.10/database<span class="w"> </span>/database<span class="w">      </span>cifs<span class="w">    </span><span class="nv">credentials</span><span class="o">=</span>/root/auth.smb<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
</ol>
<h3 id="nfs">NFS网络文件系统<a class="headerlink" href="#nfs" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>安装nfs
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-73-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># yum -y install nfs-utils.x86_64</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>放行防火墙
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-74-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --add-service=rpc-bind </span>
</span><span id="__span-74-2">success
</span><span id="__span-74-3"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --add-service=nfs</span>
</span><span id="__span-74-4">success
</span><span id="__span-74-5"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --add-service=mountd </span>
</span><span id="__span-74-6">success
</span><span id="__span-74-7"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --reload </span>
</span><span id="__span-74-8">success
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>创建共享目录和文件
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-75-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># mkdir /nfsfile</span>
</span><span id="__span-75-2"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># chmod -R 777 /nfsfile</span>
</span><span id="__span-75-3"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># echo &quot;welcome to.192.168.10.10&quot; &gt; /nfsfile/readme.md</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>编辑nfs主配置文件/etc/exports</p>
</li>
</ol>
<p>表12-7 用于配置NFS服务程序配置文件的参数</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>ro</td>
<td>只读</td>
</tr>
<tr>
<td>rw</td>
<td>读写</td>
</tr>
<tr>
<td>root_squash</td>
<td>当NFS客户端以root管理员访问时，映射为NFS服务器的匿名用户</td>
</tr>
<tr>
<td>no_root_squash</td>
<td>当NFS客户端以root管理员访问时，映射为NFS服务器的root管理员</td>
</tr>
<tr>
<td>all_squash</td>
<td>无论NFS客户端使用什么账户访问，均映射为NFS服务器的匿名用户</td>
</tr>
<tr>
<td>sync</td>
<td>同时将数据写入到内存与硬盘中，保证不丢失数据</td>
</tr>
<tr>
<td>async</td>
<td>优先将数据保存到内存，然后再写入硬盘；这样效率更高，但可能会丢失数据</td>
</tr>
</tbody>
</table>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-76-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/exports</span>
</span><span id="__span-76-2">/nfsfile<span class="w"> </span><span class="m">192</span>.168.10.*<span class="o">(</span>rw,sync,root_squash<span class="o">)</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>
<p>重启服务
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-77-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart nfs-server.service </span>
</span><span id="__span-77-2"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable --now nfs-server.service </span>
</span><span id="__span-77-3">Created<span class="w"> </span>symlink<span class="w"> </span>from<span class="w"> </span>/etc/systemd/system/multi-user.target.wants/nfs-server.service<span class="w"> </span>to<span class="w"> </span>/usr/lib/systemd/system/nfs-server.service.
</span><span id="__span-77-4"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart rpcbind</span>
</span><span id="__span-77-5"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable --now rpcbind  （远程过程调用）</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>showmount 查看NFS服务器的远程共享信息</p>
</li>
</ol>
<p>表12-8 showmount命令中可用的参数以及作用</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-e</td>
<td>显示NFS服务器的共享列表</td>
</tr>
<tr>
<td>-a</td>
<td>显示本机挂载的文件资源的情况NFS资源的情况</td>
</tr>
<tr>
<td>-v</td>
<td>显示版本号</td>
</tr>
<tr>
<td><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-78-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># showmount -e 192.168.10.10</span>
</span><span id="__span-78-2">Export<span class="w"> </span>list<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">192</span>.168.10.10:
</span><span id="__span-78-3">/nfsfile<span class="w"> </span><span class="m">192</span>.168.10.*
</span></code></pre></div></td></tr></table></div></td>
<td></td>
</tr>
</tbody>
</table>
<ol>
<li>在客户端创建挂载点并挂载
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-79-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># mkdir /nfsfile</span>
</span><span id="__span-79-2"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># mount -t nfs 192.168.10.10:/nfsfile /nfsfile</span>
</span></code></pre></div></td></tr></table></div></li>
</ol>
<h3 id="autofs">autofs自动挂载<a class="headerlink" href="#autofs" title="Permanent link">&para;</a></h3>
<ol>
<li>安装autofs</li>
</ol>
<p>yum -y install autofs</p>
<ol>
<li>编辑配置文件/etc/auto.master和/etc/auto.misc</li>
</ol>
<p>/misc /etc/auto.misc</p>
<p>nfsfile 192.168.10.10:/nfsfile</p>
<ol>
<li>创建挂载目录</li>
</ol>
<p>mkdir /misc/nfsfile</p>
<ol>
<li>
<p>重启autofs</p>
</li>
<li>
<p>进入挂载目录自动挂载</p>
</li>
</ol>
<h2 id="9bind">9.使用bind提供域名解析服务<a class="headerlink" href="#9bind" title="Permanent link">&para;</a></h2>
<h3 id="dns">DNS域名解析服务<a class="headerlink" href="#dns" title="Permanent link">&para;</a></h3>
<p>DNS技术作为互联网基础设施中重要的一环，为了为网民提供不间断、稳定且快速的域名查询服务，保证互联网的正常运转，提供了下面3种类型的服务器。</p>
<blockquote>
<p>主服务器：在特定区域内具有唯一性，负责维护该区域内的域名与IP地址之间的对应关系。</p>
<p>从服务器：从主服务器中获得域名与IP地址的对应关系并进行维护，以防主服务器宕机等情况。</p>
<p>缓存服务器：通过向其他域名解析服务器查询获得域名与IP地址的对应关系，并将经常查询的域名信息保存到服务器本地，以此来提高重复查询时的效率。</p>
</blockquote>
<h3 id="bind">安装Bind服务程序<a class="headerlink" href="#bind" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>[root@192 ~]# yum -y install bind-chroot.x86_64</p>
</li>
<li>
<p>在bind服务程序中有下面这3个比较关键的文件。</p>
</li>
</ul>
<blockquote>
<p>主配置文件（/etc/named.conf）：只有59行，而且在去除注释信息和空行之后，实际有效的参数仅有30行左右，这些参数用来定义bind服务程序的运行。</p>
<p>区域配置文件（/etc/named.rfc1912.zones）：用来保存域名和IP地址对应关系的所在位置。类似于图书的目录，对应着每个域和相应IP地址所在的具体位置，当需要查看或修改时，可根据这个位置找到相关文件。</p>
<p>数据配置文件目录（/var/named）：该目录用来保存域名和IP地址真实对应关系的数据配置文件。
</p>
</blockquote>
<ul>
<li>编辑主配置文件/etc/named.conf
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-80-1"><span class="c1">#服务器上的所有IP地址均可提供DNS域名解析服务，以及允许所有人对本服务器发送DNS查询请求</span>
</span><span id="__span-80-2"><span class="w">      </span>listen-on<span class="w"> </span>port<span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="o">{</span><span class="w"> </span>any<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-80-3"><span class="w">      </span>allow-query<span class="w">     </span><span class="o">{</span><span class="w"> </span>any<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="-ip">正向解析（域名-&gt;IP）<a class="headerlink" href="#-ip" title="Permanent link">&para;</a></h4>
<ul>
<li>编辑区域配置文件
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-81-1">zone<span class="w"> </span><span class="s2">&quot;www.minayao10.com&quot;</span><span class="w"> </span>IN<span class="w"> </span><span class="o">{</span>
</span><span id="__span-81-2"><span class="w">        </span><span class="nb">type</span><span class="w"> </span>master<span class="p">;</span>
</span><span id="__span-81-3"><span class="w">        </span>file<span class="w"> </span><span class="s2">&quot;www.minayao10.com.zone&quot;</span><span class="p">;</span>
</span><span id="__span-81-4"><span class="w">        </span>allow-update<span class="w"> </span><span class="o">{</span>none<span class="p">;</span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-81-5"><span class="o">}</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div></li>
<li>
<p>编辑数据配置文件/var/named/minayao.com.zone
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-82-1"><span class="nv">$TTL</span><span class="w"> </span>1D
</span><span id="__span-82-2">@<span class="w">       </span>IN<span class="w"> </span>SOA<span class="w">  </span>minayao.com.<span class="w"> </span>root.minayao.com.<span class="w"> </span><span class="o">(</span>
</span><span id="__span-82-3"><span class="w">                                        </span><span class="m">0</span><span class="w">       </span><span class="p">;</span><span class="w"> </span>serial
</span><span id="__span-82-4"><span class="w">                                        </span>1D<span class="w">      </span><span class="p">;</span><span class="w"> </span>refresh
</span><span id="__span-82-5"><span class="w">                                        </span>1H<span class="w">      </span><span class="p">;</span><span class="w"> </span>retry
</span><span id="__span-82-6"><span class="w">                                        </span>1W<span class="w">      </span><span class="p">;</span><span class="w"> </span>expire
</span><span id="__span-82-7"><span class="w">                                        </span>3H<span class="w"> </span><span class="o">)</span><span class="w">    </span><span class="p">;</span><span class="w"> </span>minimum
</span><span id="__span-82-8"><span class="w">        </span>NS<span class="w">      </span>ns.minayao10.com.
</span><span id="__span-82-9">ns<span class="w">      </span>IN<span class="w"> </span>A<span class="w">    </span><span class="m">192</span>.168.1.10
</span><span id="__span-82-10">www<span class="w">     </span>IN<span class="w"> </span>A<span class="w">    </span><span class="m">192</span>.168.1.10
</span><span id="__span-82-11"><span class="w">        </span>AAAA<span class="w">    </span>::1
</span></code></pre></div></td></tr></table></div>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-83-1"><span class="nv">$TTL</span><span class="w"> </span>1D<span class="w">     </span><span class="c1">#生存周期为1天                </span>
</span><span id="__span-83-2">@<span class="w">   </span>IN<span class="w"> </span>SOA<span class="w">  </span>linuxprobe.com.<span class="w">     </span>root.linuxprobe.com.<span class="w">    </span><span class="o">(</span><span class="w">   </span>
</span><span id="__span-83-3"><span class="w">    </span><span class="c1">#授权信息开始:    #DNS区域的地址   #域名管理员的邮箱(不要用@符号)   </span>
</span><span id="__span-83-4"><span class="w">                </span><span class="m">0</span><span class="p">;</span>serial<span class="w">    </span><span class="c1">#更新序列号</span>
</span><span id="__span-83-5"><span class="w">                </span>1D<span class="p">;</span>refresh<span class="w">  </span><span class="c1">#更新时间</span>
</span><span id="__span-83-6"><span class="w">                </span>1H<span class="p">;</span>retry<span class="w">    </span><span class="c1">#重试延时</span>
</span><span id="__span-83-7"><span class="w">                </span>1W<span class="p">;</span>expire<span class="w">   </span><span class="c1">#失效时间</span>
</span><span id="__span-83-8"><span class="w">                </span>3H<span class="w"> </span><span class="o">)</span><span class="p">;</span>minimum<span class="w">    </span><span class="c1">#无效解析记录的缓存时间</span>
</span><span id="__span-83-9"><span class="w">    </span>NS<span class="w">  </span>ns.linuxprobe.com.<span class="w">  </span><span class="c1">#域名服务器记录</span>
</span><span id="__span-83-10">ns<span class="w">  </span>IN<span class="w"> </span>A<span class="w">    </span><span class="m">192</span>.168.10.10<span class="w">   </span><span class="c1">#地址记录(ns.linuxprobe.com.)</span>
</span><span id="__span-83-11">www<span class="w">     </span>IN<span class="w"> </span>A<span class="w">    </span><span class="m">192</span>.168.10.10<span class="w">   </span><span class="c1">#地址记录(www.linuxprobe.com.)</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>将网卡DNS地址参数改成本机IP，nmcli重启，并重启named服务</p>
</li>
<li>
<p>nslookup确认服务器信息是否为“Address: 192.168.10.10#53”，即由本地服务器192.168.10.10的53端口号进行解析；若不是，则重启网络后再试一下。</p>
</li>
</ul>
<h4 id="ip-">反向解析（IP-&gt;域名）<a class="headerlink" href="#ip-" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>区域配置文件/etc/named.rfc1912.zones
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-84-1">zone<span class="w"> </span><span class="s2">&quot;1.168.192.in-addr.arpa&quot;</span><span class="w"> </span>IN<span class="w"> </span><span class="o">{</span>
</span><span id="__span-84-2"><span class="w">        </span><span class="nb">type</span><span class="w"> </span>master<span class="p">;</span>
</span><span id="__span-84-3"><span class="w">        </span>file<span class="w"> </span><span class="s2">&quot;192.168.1.arpa&quot;</span>
</span><span id="__span-84-4"><span class="w">        </span>allow-update<span class="w"> </span><span class="o">{</span>none<span class="p">;</span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-84-5"><span class="o">}</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>数据配置文件/var/named/192.168.1.arpa
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-85-1"><span class="nv">$TTL</span><span class="w"> </span>1D
</span><span id="__span-85-2">@<span class="w">       </span>IN<span class="w"> </span>SOA<span class="w">  </span>minayo.com.<span class="w">     </span>root.minayao.com.<span class="w"> </span><span class="o">(</span>
</span><span id="__span-85-3"><span class="w">                                        </span><span class="m">0</span><span class="w">       </span><span class="p">;</span><span class="w"> </span>serial
</span><span id="__span-85-4"><span class="w">                                        </span>1D<span class="w">      </span><span class="p">;</span><span class="w"> </span>refresh
</span><span id="__span-85-5"><span class="w">                                        </span>1H<span class="w">      </span><span class="p">;</span><span class="w"> </span>retry
</span><span id="__span-85-6"><span class="w">                                        </span>1W<span class="w">      </span><span class="p">;</span><span class="w"> </span>expire
</span><span id="__span-85-7"><span class="w">                                        </span>3H<span class="w"> </span><span class="o">)</span><span class="w">    </span><span class="p">;</span><span class="w"> </span>minimum
</span><span id="__span-85-8"><span class="w">        </span>NS<span class="w">      </span>ns.minayao.com.
</span><span id="__span-85-9"><span class="w">        </span>A<span class="w">       </span><span class="m">192</span>.168.1.10
</span><span id="__span-85-10"><span class="w">        </span>AAAA<span class="w">    </span>::1
</span><span id="__span-85-11"><span class="m">10</span><span class="w">      </span>PTR<span class="w">     </span>ns.minayao.com.
</span><span id="__span-85-12"><span class="m">10</span><span class="w">      </span>PTR<span class="w">     </span>www.minayao.com.
</span><span id="__span-85-13"><span class="m">20</span><span class="w">      </span>PTR<span class="w">     </span>bbs.minayao.com.
</span><span id="__span-85-14">注：PTR为指针记录，仅用于反向解析中，nslookup命令用于检测能否从DNS服务器中查询到域名与IP地址的解析记录
</span></code></pre></div></td></tr></table></div></p>
</li>
</ul>
<h3 id="_29">部署从服务器<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<p>通过部署从服务器不仅可以减轻主服务器的负载压力，还可以提升用户的查询效率。</p>
<ol>
<li>
<p>修改allow-update {192.168.1.20;}; IP为从服务器的IP，重启named</p>
</li>
<li>
<p>防火墙放行dns
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-86-1"><span class="o">[</span>root@minayao<span class="w"> </span>named<span class="o">]</span><span class="c1"># iptables -F</span>
</span><span id="__span-86-2"><span class="o">[</span>root@minayao<span class="w"> </span>named<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --add-service=dns</span>
</span><span id="__span-86-3">success
</span><span id="__span-86-4"><span class="o">[</span>root@minayao<span class="w"> </span>named<span class="o">]</span><span class="c1"># firewall-cmd --reload </span>
</span><span id="__span-86-5">success
</span><span id="__span-86-6"><span class="o">[</span>root@minayao<span class="w"> </span>named<span class="o">]</span><span class="c1"># </span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>在从服务器上安装bind-chroot，并修改主配置文件/etc/named.conf
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-87-1">listen-on<span class="w"> </span>port<span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="o">{</span><span class="w"> </span>any<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-87-2">allow-query<span class="w">     </span><span class="o">{</span><span class="w"> </span>any<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>在从服务器中填写主服务器的IP和抓取的区域信息，重启服务
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-88-1"><span class="o">[</span>root@localhost<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/named.rfc1912.zones </span>
</span><span id="__span-88-2">zone<span class="w"> </span><span class="s2">&quot;minayao.com&quot;</span><span class="w"> </span>IN<span class="w"> </span><span class="o">{</span>
</span><span id="__span-88-3"><span class="w">        </span><span class="nb">type</span><span class="w"> </span>slave<span class="p">;</span>
</span><span id="__span-88-4"><span class="w">        </span>masters<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="m">192</span>.168.1.10<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-88-5"><span class="w">        </span>file<span class="w"> </span><span class="s2">&quot;slaves/minayao.com.zone&quot;</span><span class="p">;</span>
</span><span id="__span-88-6"><span class="o">}</span><span class="p">;</span>
</span><span id="__span-88-7">zone<span class="w"> </span><span class="s2">&quot;1.168.192.in-addr.arpa&quot;</span><span class="w"> </span>IN<span class="w"> </span><span class="o">{</span>
</span><span id="__span-88-8"><span class="nb">type</span><span class="w"> </span>slave<span class="p">;</span>
</span><span id="__span-88-9">masters<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="m">192</span>.168.1.10<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-88-10">file<span class="w"> </span><span class="s2">&quot;slaves/192.168.1.arpa&quot;</span><span class="p">;</span>
</span><span id="__span-88-11"><span class="o">}</span><span class="p">;</span>
</span><span id="__span-88-12"><span class="o">[</span>root@localhost<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart named</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>检验，将从服务器的dns参数改成192.168.1.20（此处如果是DHCP分配的IP会出问题，可以新建连接，用nmcli手动配置连接的参数，）并up起来
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-89-1"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># nmcli connection add con-name zidong type ethernet ifname ens32 </span>
</span><span id="__span-89-2"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># nmcli connection modify zidong ipv4.method manual ipv4.addresses 192.168.1.20/24 ipv4.gateway 192.168.1.2 ipv4.dns 192.168.1.20 autoconnect yes</span>
</span><span id="__span-89-3"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># nmcli connection up zidong </span>
</span><span id="__span-89-4"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># nslookup </span>
</span><span id="__span-89-5">&gt;<span class="w"> </span>www.baidu.com
</span><span id="__span-89-6">Server:<span class="w">     </span><span class="m">192</span>.168.1.20
</span><span id="__span-89-7">Address:<span class="w">    </span><span class="m">192</span>.168.1.20#53
</span><span id="__span-89-8">Non-authoritative<span class="w"> </span>answer:
</span><span id="__span-89-9">www.baidu.com<span class="w">   </span>canonical<span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>www.a.shifen.com.
</span><span id="__span-89-10">Name:<span class="w">   </span>www.a.shifen.com
</span><span id="__span-89-11">Address:<span class="w"> </span><span class="m">112</span>.80.248.75
</span><span id="__span-89-12">Name:<span class="w">   </span>www.a.shifen.com
</span><span id="__span-89-13">Address:<span class="w"> </span><span class="m">112</span>.80.248.76
</span><span id="__span-89-14">&gt;<span class="w"> </span>www.minayao.com
</span><span id="__span-89-15">Server:<span class="w">     </span><span class="m">192</span>.168.1.20
</span><span id="__span-89-16">Address:<span class="w">    </span><span class="m">192</span>.168.1.20#53
</span><span id="__span-89-17">
</span><span id="__span-89-18">
</span><span id="__span-89-19">Name:<span class="w">   </span>www.minayao.com
</span><span id="__span-89-20">Address:<span class="w"> </span><span class="m">192</span>.168.1.10
</span></code></pre></div></td></tr></table></div></p>
</li>
</ol>
<hr />
<h3 id="_30">安全的加密传输<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>配置主服务器</p>
</li>
<li>
<p>生成DNS安全密钥
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-90-1"><span class="o">[</span>root@localhost<span class="w"> </span>~<span class="o">]</span><span class="c1"># dnssec-keygen -a HMAC-MD5 -b 128 -n HOST master-slave</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>创建密钥验证文件transfer.key，写入密钥名称、加密算法、私钥字符等。更改权限、属组，设置硬链指向/etc/transfer.key
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-91-1"><span class="o">[</span>root@localhost<span class="w"> </span>etc<span class="o">]</span><span class="c1"># vim transfer.key </span>
</span><span id="__span-91-2">key<span class="w"> </span><span class="s2">&quot;master-slave&quot;</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-91-3"><span class="w">    </span>algorithm<span class="w"> </span>hmac-md5<span class="p">;</span>
</span><span id="__span-91-4"><span class="w">    </span>secret<span class="w"> </span><span class="s2">&quot;M7E5DcFHZrOtXR+7qBpBeg==&quot;</span><span class="p">;</span>
</span><span id="__span-91-5"><span class="o">}</span><span class="p">;</span>
</span><span id="__span-91-6"><span class="o">[</span>root@localhost<span class="w"> </span>etc<span class="o">]</span><span class="c1"># chown root:named transfer.key </span>
</span><span id="__span-91-7"><span class="o">[</span>root@localhost<span class="w"> </span>etc<span class="o">]</span><span class="c1"># chmod 640 transfer.key </span>
</span><span id="__span-91-8"><span class="o">[</span>root@localhost<span class="w"> </span>etc<span class="o">]</span><span class="c1"># ln transfer.key /etc/transfer.key </span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>配置主配置文件，开启bind服务的密钥验证功能
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-92-1"><span class="o">[</span>root@localhost<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/named.conf </span>
</span><span id="__span-92-2">include<span class="w"> </span><span class="s2">&quot;/etc/transfer.key&quot;</span><span class="p">;</span>
</span><span id="__span-92-3">option<span class="w">  </span>添加<span class="w">      </span>allow-transfer<span class="w">  </span><span class="o">{</span><span class="w"> </span>key<span class="w"> </span>master-slave<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>配置从服务器</p>
</li>
<li>
<p>删除/var/named/slaves下的文件</p>
</li>
<li>
<p>创建密钥文件，并设置权限，同主服务器
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-93-1"><span class="o">[</span>root@localhost<span class="w"> </span>etc<span class="o">]</span><span class="c1"># vim transfer.key </span>
</span><span id="__span-93-2">key<span class="w"> </span><span class="s2">&quot;master-slave&quot;</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-93-3"><span class="w">    </span>algorithm<span class="w"> </span>hmac-md5<span class="p">;</span>
</span><span id="__span-93-4"><span class="w">    </span>secret<span class="w"> </span><span class="s2">&quot;M7E5DcFHZrOtXR+7qBpBeg==&quot;</span><span class="p">;</span>
</span><span id="__span-93-5"><span class="o">}</span><span class="p">;</span>
</span><span id="__span-93-6"><span class="o">[</span>root@localhost<span class="w"> </span>etc<span class="o">]</span><span class="c1"># chown root:named transfer.key </span>
</span><span id="__span-93-7"><span class="o">[</span>root@localhost<span class="w"> </span>etc<span class="o">]</span><span class="c1"># chmod 640 transfer.key </span>
</span><span id="__span-93-8"><span class="o">[</span>root@localhost<span class="w"> </span>etc<span class="o">]</span><span class="c1"># ln transfer.key /etc/transfer.key </span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>配置主配置文件/etc/named.conf
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-94-1">include<span class="w"> </span><span class="s2">&quot;/etc/transfer.key&quot;</span><span class="p">;</span>
</span><span id="__span-94-2">server<span class="w"> </span><span class="m">192</span>.168.1.10
</span><span id="__span-94-3"><span class="o">{</span>
</span><span id="__span-94-4"><span class="w">        </span>keys<span class="w"> </span><span class="o">{</span><span class="w"> </span>master-slave<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-94-5"><span class="o">}</span><span class="p">;</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>重启named服务，查看slaves下有数据文件了</p>
</li>
<li>
<p>验证
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-95-1"><span class="o">[</span>root@localhost<span class="w"> </span>slaves<span class="o">]</span><span class="c1"># nslookup www.minayao.com</span>
</span><span id="__span-95-2">Server:<span class="w">     </span><span class="m">192</span>.168.1.20
</span><span id="__span-95-3">Address:<span class="w">    </span><span class="m">192</span>.168.1.20#53
</span><span id="__span-95-4">Name:<span class="w">   </span>www.minayao.com
</span><span id="__span-95-5">Address:<span class="w"> </span><span class="m">192</span>.168.1.10
</span><span id="__span-95-6">
</span><span id="__span-95-7">
</span><span id="__span-95-8"><span class="o">[</span>root@localhost<span class="w"> </span>slaves<span class="o">]</span><span class="c1"># nslookup 192.168.1.10</span>
</span><span id="__span-95-9">Server:<span class="w">     </span><span class="m">192</span>.168.1.20
</span><span id="__span-95-10">Address:<span class="w">    </span><span class="m">192</span>.168.1.20#53
</span><span id="__span-95-11">
</span><span id="__span-95-12">
</span><span id="__span-95-13"><span class="m">10</span>.1.168.192.in-addr.arpa<span class="w">   </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>www.minayao.com.
</span><span id="__span-95-14"><span class="m">10</span>.1.168.192.in-addr.arpa<span class="w">   </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ns.minayao.com.
</span><span id="__span-95-15">
</span><span id="__span-95-16">
</span><span id="__span-95-17"><span class="o">[</span>root@localhost<span class="w"> </span>slaves<span class="o">]</span><span class="c1"># nslookup 192.168.1.20</span>
</span><span id="__span-95-18">Server:<span class="w">     </span><span class="m">192</span>.168.1.20
</span><span id="__span-95-19">Address:<span class="w">    </span><span class="m">192</span>.168.1.20#53
</span><span id="__span-95-20">
</span><span id="__span-95-21">
</span><span id="__span-95-22"><span class="m">20</span>.1.168.192.in-addr.arpa<span class="w">   </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>bbs.minayao.com.
</span></code></pre></div></td></tr></table></div></p>
</li>
</ol>
<h3 id="_31">部署缓存服务器<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-96-1">cat<span class="w"> </span>/etc/named.conf
</span><span id="__span-96-2">
</span><span id="__span-96-3">forwarders<span class="w">  </span><span class="o">{</span><span class="w"> </span><span class="m">114</span>.114.114.114<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-96-4">systemctl<span class="w"> </span>restart<span class="w"> </span>named
</span><span id="__span-96-5">将客户端网络dns参数设置成缓存服务器的地址
</span></code></pre></div></td></tr></table></div>
<div class="admonition 分离解析技术">
<p class="admonition-title">分离解析技术</p>
</div>
<h2 id="10dhcp">10.使用DHCP动态管理主机地址<a class="headerlink" href="#10dhcp" title="Permanent link">&para;</a></h2>
<h3 id="dhcpd">部署dhcpd服务程序<a class="headerlink" href="#dhcpd" title="Permanent link">&para;</a></h3>
<ul>
<li>安装
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-97-1"><span class="o">[</span>root@www<span class="w"> </span>~<span class="o">]</span><span class="c1"># yum -y install dhcp</span>
</span></code></pre></div></td></tr></table></div></li>
<li>编辑配置文件/etc/dhcp/dhcpd.conf</li>
<li>表14-1 dhcpd服务程序配置文件中使用的常见参数以及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>ddns-update-style 类型</td>
<td>定义DNS服务动态更新的类型，类型包括： none（不支持动态更新）、interim（互动更新模式）与ad-hoc（特殊更新模式）</td>
</tr>
<tr>
<td>allow/ignore client-updates</td>
<td>允许/忽略客户端更新DNS记录</td>
</tr>
<tr>
<td>default-lease-time 21600</td>
<td>默认超时时间</td>
</tr>
<tr>
<td>max-lease-time 43200   最大超时时间</td>
<td></td>
</tr>
<tr>
<td>option domain-name-servers 8.8.8.8</td>
<td>定义DNS服务器地址</td>
</tr>
<tr>
<td>option domain-name "domain.org"</td>
<td>定义DNS域名</td>
</tr>
<tr>
<td>range</td>
<td>定义用于分配的IP地址池</td>
</tr>
<tr>
<td>option subnet-mask</td>
<td>定义客户端的子网掩码</td>
</tr>
<tr>
<td>option routers</td>
<td>定义客户端的网关地址</td>
</tr>
<tr>
<td>broadcast-address 广播地址</td>
<td>定义客户端的广播地址</td>
</tr>
<tr>
<td>ntp-server IP地址</td>
<td>定义客户端的网络时间服务器（NTP）</td>
</tr>
<tr>
<td>nis-servers IP地址</td>
<td>定义客户端的NIS域服务器的地址</td>
</tr>
<tr>
<td>hardware 硬件类型 MAC地址</td>
<td>指定网卡接口的类型与MAC地址</td>
</tr>
<tr>
<td>server-name 主机名</td>
<td>向DHCP客户端通知DHCP服务器的主机名</td>
</tr>
<tr>
<td>fixed-address IP地址</td>
<td>将某个固定的IP地址分配给指定主机</td>
</tr>
<tr>
<td>time-offset 偏移差</td>
<td>指定客户端与格林尼治时间的偏移差</td>
</tr>
</tbody>
</table>
<h3 id="ip">自动管理IP地址<a class="headerlink" href="#ip" title="Permanent link">&para;</a></h3>
<p>服务端
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-98-1"><span class="c1"># DHCP Server Configuration file.</span>
</span><span id="__span-98-2"><span class="c1">#   see /usr/share/doc/dhcp*/dhcpd.conf.example</span>
</span><span id="__span-98-3"><span class="c1">#   see dhcpd.conf(5) man page</span>
</span><span id="__span-98-4"><span class="c1">#</span>
</span><span id="__span-98-5">ddns-update-style<span class="w"> </span>none<span class="p">;</span>
</span><span id="__span-98-6">ignore<span class="w"> </span>client-updates<span class="p">;</span>
</span><span id="__span-98-7">subnet<span class="w"> </span><span class="m">192</span>.168.1.0<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.255.255.0<span class="w"> </span><span class="o">{</span>
</span><span id="__span-98-8">range<span class="w"> </span><span class="m">192</span>.168.1.50<span class="w"> </span><span class="m">192</span>.168.1.150<span class="p">;</span>
</span><span id="__span-98-9">option<span class="w"> </span>subnet-mask<span class="w"> </span><span class="m">255</span>.255.255.0<span class="p">;</span>
</span><span id="__span-98-10">option<span class="w"> </span>routers<span class="w"> </span><span class="m">192</span>.168.1.10<span class="p">;</span>
</span><span id="__span-98-11">option<span class="w"> </span>domain-name<span class="w"> </span><span class="s2">&quot;www.minayao10.com&quot;</span><span class="p">;</span>
</span><span id="__span-98-12">option<span class="w"> </span>domain-name-servers<span class="w"> </span><span class="m">192</span>.168.1.10<span class="p">;</span>
</span><span id="__span-98-13">default-lease-time<span class="w"> </span><span class="m">21600</span><span class="p">;</span>
</span><span id="__span-98-14">max-lease-time<span class="w"> </span><span class="m">43200</span><span class="p">;</span>
</span><span id="__span-98-15"><span class="o">}</span>
</span></code></pre></div></td></tr></table></div></p>
<p>客户端
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-99-1"><span class="nv">TYPE</span><span class="o">=</span><span class="s2">&quot;Ethernet&quot;</span>
</span><span id="__span-99-2"><span class="nv">BOOTPROTO</span><span class="o">=</span><span class="s2">&quot;dhcp&quot;</span>
</span><span id="__span-99-3"><span class="nv">ONBOOT</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span>
</span></code></pre></div></td></tr></table></div></p>
<ul>
<li>表14-4 dhcpd服务程序配置文件中使用的参数以及作用</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>ddns-update-style none;</td>
<td>设置DNS服务不自动进行动态更新</td>
</tr>
<tr>
<td>ignore client-updates; 忽略客户端更新DNS记录</td>
<td></td>
</tr>
<tr>
<td>subnet 192.168.10.0 netmask 255.255.255.0 {</td>
<td>作用域为192.168.10.0/24网段</td>
</tr>
<tr>
<td>range 192.168.10.50 192.168.10.150;</td>
<td>IP地址池为192.168.10.50-150（约100个IP地址）</td>
</tr>
<tr>
<td>option subnet-mask 255.255.255.0;</td>
<td>定义客户端默认的子网掩码</td>
</tr>
<tr>
<td>option routers 192.168.10.1;</td>
<td>定义客户端的网关地址</td>
</tr>
<tr>
<td>option domain-name "linuxprobe.com";</td>
<td>定义默认的搜索域</td>
</tr>
<tr>
<td>option domain-name-servers 192.168.10.1;</td>
<td>定义客户端的DNS地址</td>
</tr>
<tr>
<td>default-lease-time 21600;</td>
<td>定义默认租约时间（单位：秒）</td>
</tr>
<tr>
<td>max-lease-time 43200;</td>
<td>定义最大预约时间（单位：秒）</td>
</tr>
<tr>
<td>}</td>
<td>结束符</td>
</tr>
<tr>
<td><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-100-1"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart dhcpd</span>
</span><span id="__span-100-2"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable --now dhcpd</span>
</span><span id="__span-100-3"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --permanent --zone=public --add-service=dhcp</span>
</span><span id="__span-100-4"><span class="o">[</span>root@192<span class="w"> </span>~<span class="o">]</span><span class="c1"># firewall-cmd --reload </span>
</span></code></pre></div></td></tr></table></div></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="ip_1">分配固定IP地址<a class="headerlink" href="#ip_1" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-101-1"><span class="c1"># DHCP Server Configuration file.</span>
</span><span id="__span-101-2"><span class="c1">#   see /usr/share/doc/dhcp*/dhcpd.conf.example</span>
</span><span id="__span-101-3"><span class="c1">#   see dhcpd.conf(5) man page</span>
</span><span id="__span-101-4"><span class="c1">#</span>
</span><span id="__span-101-5">ddns-update-style<span class="w"> </span>none<span class="p">;</span>
</span><span id="__span-101-6">ignore<span class="w"> </span>client-updates<span class="p">;</span>
</span><span id="__span-101-7">subnet<span class="w"> </span><span class="m">192</span>.168.1.0<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.255.255.0<span class="w"> </span><span class="o">{</span>
</span><span id="__span-101-8">range<span class="w"> </span><span class="m">192</span>.168.1.50<span class="w"> </span><span class="m">192</span>.168.1.150<span class="p">;</span>
</span><span id="__span-101-9">option<span class="w"> </span>subnet-mask<span class="w"> </span><span class="m">255</span>.255.255.0<span class="p">;</span>
</span><span id="__span-101-10">option<span class="w"> </span>routers<span class="w"> </span><span class="m">192</span>.168.1.10<span class="p">;</span>
</span><span id="__span-101-11">option<span class="w"> </span>domain-name<span class="w"> </span><span class="s2">&quot;www.minayao10.com&quot;</span><span class="p">;</span>
</span><span id="__span-101-12">option<span class="w"> </span>domain-name-servers<span class="w"> </span><span class="m">192</span>.168.1.10<span class="p">;</span>
</span><span id="__span-101-13">default-lease-time<span class="w"> </span><span class="m">21600</span><span class="p">;</span>
</span><span id="__span-101-14">max-lease-time<span class="w"> </span><span class="m">43200</span><span class="p">;</span>
</span><span id="__span-101-15">host<span class="w"> </span>www.minayao10.com<span class="w"> </span><span class="o">{</span>
</span><span id="__span-101-16">hardware<span class="w"> </span>ethernet<span class="w"> </span><span class="m">00</span>:0c:29:76:8b:a0<span class="p">;</span>
</span><span id="__span-101-17">fixed-address<span class="w"> </span><span class="m">192</span>.168.1.100<span class="p">;</span>
</span><span id="__span-101-18"><span class="o">}</span>
</span><span id="__span-101-19"><span class="o">}</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="11postfixdovecot">11.使用Postfix与Dovecot部署邮件系统<a class="headerlink" href="#11postfixdovecot" title="Permanent link">&para;</a></h2>
<h3 id="_32">电子邮件系统<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<p>电子邮件系统基于邮件协议来完成电子邮件的传输，常见的邮件协议有下面这些。</p>
<blockquote>
<p>简单邮件传输协议（Simple Mail Transfer Protocol，SMTP）：用于发送和中转发出的电子邮件，占用服务器的TCP/25端口。</p>
<p>邮局协议版本3（Post Office Protocol 3）：用于将电子邮件存储到本地主机，占用服务器的TCP/110端口。</p>
<p>Internet消息访问协议版本4（Internet Message Access Protocol 4）：用于在本地主机上访问邮件，占用服务器的TCP/143端口。</p>
</blockquote>
<p>大家在生产环境中部署企业级的电子邮件系统时，有4个注意事项请留意。</p>
<blockquote>
<p>添加反垃圾与反病毒模块：它能够很有效地阻止垃圾邮件或病毒邮件对企业信箱的干扰。</p>
<p>对邮件加密：可有效保护邮件内容不被黑客盗取和篡改。</p>
<p>添加邮件监控审核模块：可有效地监控企业全体员工的邮件中是否有敏感词，是否有透露企业资料等违规行为。</p>
<p>保障稳定性：电子邮件系统的稳定性至关重要，运维人员应做到保证电子邮件系统的稳定运行，并及时做好防范分布式拒绝服务（Distributed Denial of Service，DDoS）攻击的准备。</p>
</blockquote>
<h3 id="_33">部署基础的电子邮件系统<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>配置服务器主机名，服务器主机名需要和发信域名保持一致</p>
</li>
<li>
<p>清空防火墙，允许DNS协议</p>
</li>
<li>
<p>为电子邮件系统提供域名解析（bind-chroot）</p>
</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-102-1"><span class="m">1</span>.主配置文件/etc/named.conf
</span><span id="__span-102-2">options<span class="w"> </span><span class="o">{</span>
</span><span id="__span-102-3"><span class="w">    </span>listen-on<span class="w"> </span>port<span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="o">{</span><span class="w"> </span>any<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span><span class="w">    </span>⬅here
</span><span id="__span-102-4"><span class="w">    </span>listen-on-v6<span class="w"> </span>port<span class="w"> </span><span class="m">53</span><span class="w"> </span><span class="o">{</span><span class="w"> </span>::1<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-102-5"><span class="w">    </span>directory<span class="w">   </span><span class="s2">&quot;/var/named&quot;</span><span class="p">;</span>
</span><span id="__span-102-6"><span class="w">    </span>dump-file<span class="w">   </span><span class="s2">&quot;/var/named/data/cache_dump.db&quot;</span><span class="p">;</span>
</span><span id="__span-102-7"><span class="w">    </span>statistics-file<span class="w"> </span><span class="s2">&quot;/var/named/data/named_stats.txt&quot;</span><span class="p">;</span>
</span><span id="__span-102-8"><span class="w">    </span>memstatistics-file<span class="w"> </span><span class="s2">&quot;/var/named/data/named_mem_stats.txt&quot;</span><span class="p">;</span>
</span><span id="__span-102-9"><span class="w">    </span>recursing-file<span class="w">  </span><span class="s2">&quot;/var/named/data/named.recursing&quot;</span><span class="p">;</span>
</span><span id="__span-102-10"><span class="w">    </span>secroots-file<span class="w">   </span><span class="s2">&quot;/var/named/data/named.secroots&quot;</span><span class="p">;</span>
</span><span id="__span-102-11"><span class="w">    </span>allow-query<span class="w">     </span><span class="o">{</span><span class="w"> </span>any<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span><span class="w">   </span>⬅here
</span><span id="__span-102-12">
</span><span id="__span-102-13"><span class="m">2</span>.区域配置文件/etc/named.rfc1912.zones
</span><span id="__span-102-14"><span class="w">  </span>zone<span class="w"> </span><span class="s2">&quot;minayao.com&quot;</span><span class="w"> </span>IN<span class="w"> </span><span class="o">{</span>
</span><span id="__span-102-15"><span class="w">    </span><span class="nb">type</span><span class="w"> </span>master<span class="p">;</span>
</span><span id="__span-102-16"><span class="w">    </span>file<span class="w"> </span><span class="s2">&quot;minayao.com.zone&quot;</span><span class="p">;</span>
</span><span id="__span-102-17"><span class="w">    </span>allow-update<span class="w"> </span><span class="o">{</span><span class="w"> </span>none<span class="p">;</span><span class="w"> </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-102-18"><span class="w">  </span><span class="o">}</span><span class="p">;</span>
</span><span id="__span-102-19"><span class="m">3</span>.域名数据文件/var/named/minayao.com.zone
</span><span id="__span-102-20"><span class="nv">$TTL</span><span class="w"> </span>1D
</span><span id="__span-102-21">@<span class="w">   </span>IN<span class="w"> </span>SOA<span class="w">  </span>minayao.com.<span class="w"> </span>root.minayao.com.<span class="w"> </span><span class="o">(</span>
</span><span id="__span-102-22"><span class="w">                    </span><span class="m">0</span><span class="w">   </span><span class="p">;</span><span class="w"> </span>serial
</span><span id="__span-102-23"><span class="w">                    </span>1D<span class="w">  </span><span class="p">;</span><span class="w"> </span>refresh
</span><span id="__span-102-24"><span class="w">                    </span>1H<span class="w">  </span><span class="p">;</span><span class="w"> </span>retry
</span><span id="__span-102-25"><span class="w">                    </span>1W<span class="w">  </span><span class="p">;</span><span class="w"> </span>expire
</span><span id="__span-102-26"><span class="w">                    </span>3H<span class="w"> </span><span class="o">)</span><span class="w">    </span><span class="p">;</span><span class="w"> </span>minimum
</span><span id="__span-102-27"><span class="w">    </span>NS<span class="w">  </span>ns.minayao.com.
</span><span id="__span-102-28">ns<span class="w">  </span>IN<span class="w"> </span>A<span class="w">    </span><span class="m">192</span>.168.10.10
</span><span id="__span-102-29">@<span class="w">   </span>IN<span class="w"> </span>MX<span class="w"> </span><span class="m">10</span><span class="w">    </span>mail.minayao.com.
</span><span id="__span-102-30">mail<span class="w">    </span>IN<span class="w"> </span>A<span class="w">    </span><span class="m">192</span>.168.10.10
</span><span id="__span-102-31"><span class="m">4</span>.重启bind（named）
</span><span id="__span-102-32"><span class="m">5</span>.尝试ping<span class="w"> </span>mail.minayao.com,若能解析地址则正确
</span></code></pre></div></td></tr></table></div>
<h4 id="postfix">配置Postfix服务程序<a class="headerlink" href="#postfix" title="Permanent link">&para;</a></h4>
<ol>
<li>安装postfix
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-103-1"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># yum -y install postfix.x86_64</span>
</span></code></pre></div></td></tr></table></div></li>
<li>配置postfix服务</li>
</ol>
<p>Postfix服务程序主配置文件中的重要参数</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>myhostname</td>
<td>邮局系统的主机名</td>
</tr>
<tr>
<td>mydomain</td>
<td>邮局系统的域名</td>
</tr>
<tr>
<td>myorigin</td>
<td>从本机发出邮件的域名名称</td>
</tr>
<tr>
<td>inet_interfaces</td>
<td>监听的网卡接口</td>
</tr>
<tr>
<td>mydestination</td>
<td>可接收邮件的主机名或域名</td>
</tr>
<tr>
<td>mynetworks</td>
<td>设置可转发哪些主机的邮件</td>
</tr>
<tr>
<td>relay_domains</td>
<td>设置可转发哪些网域的邮件</td>
</tr>
</tbody>
</table>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-104-1"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/postfix/main.cf </span>
</span><span id="__span-104-2"><span class="nv">myhostname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>mail.minayao.com
</span><span id="__span-104-3"><span class="nv">mydomain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>minayao.com
</span><span id="__span-104-4"><span class="nv">myorigin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$mydomain</span>
</span><span id="__span-104-5"><span class="nv">inet_interfaces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>all
</span><span id="__span-104-6"><span class="nv">mydestination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$myhostname</span>,<span class="w"> </span><span class="nv">$mydomain</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>创建邮件系统登录账户
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-105-1"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># useradd gm</span>
</span><span id="__span-105-2"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># echo qqqq | passwd --stdin gm</span>
</span><span id="__span-105-3"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart postfix.service </span>
</span><span id="__span-105-4"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable --now postfix.service </span>
</span><span id="__span-105-5"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl status postfix.service </span>
</span></code></pre></div></td></tr></table></div></li>
</ol>
<h4 id="dovecot">配置Dovecot服务程序<a class="headerlink" href="#dovecot" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>安装dovecot
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-106-1"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># yum -y install dovecot.x86_64</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>配置部署Dovecot服务程序
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-107-1"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/dovecot/dovecot.conf </span>
</span><span id="__span-107-2"><span class="nv">protocols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>imap<span class="w"> </span>pop3<span class="w"> </span>lmtp
</span><span id="__span-107-3"><span class="nv">disable_plaintext_auth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>no
</span><span id="__span-107-4"><span class="nv">login_trusted_networks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">192</span>.168.10.10/24
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>配置邮件格式与存储路径
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-108-1"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># vim /etc/dovecot/conf.d/10-mail.conf </span>
</span><span id="__span-108-2"><span class="nv">mail_location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>mbox:~/mail:INBOX<span class="o">=</span>/var/mail/%u
</span><span id="__span-108-3"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># su - gm</span>
</span><span id="__span-108-4"><span class="o">[</span>gm@mail<span class="w"> </span>~<span class="o">]</span><span class="c1">#  mkdir -p mail/.imap/INBOX</span>
</span><span id="__span-108-5"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl restart dovecot</span>
</span><span id="__span-108-6"><span class="o">[</span>root@mail<span class="w"> </span>~<span class="o">]</span><span class="c1"># systemctl enable --now dovecot</span>
</span></code></pre></div></td></tr></table></div></li>
</ol>
<h4 id="_34">客户使用电子邮件新系统<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p>配置IP在同一网段，DNS为邮件系统的IP</p>
</li>
<li>
<p>使用客户端(如outlook、thunderbird等)
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-109-1"><span class="c1">#1.安装thunderbird</span>
</span><span id="__span-109-2">yum<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>thunderbird
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>查看邮件mailx</li>
</ol>
<h3 id="_35">设置用户别名邮箱<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<h2 id="12iscsi">12.使用ISCSI服务部署网络存储<a class="headerlink" href="#12iscsi" title="Permanent link">&para;</a></h2>
<h3 id="_36">无人值守安装系统<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h3>
<ol>
<li>安装配置dhcp
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-110-1"><span class="o">[</span>root@192<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># yum -y install dhcp</span>
</span><span id="__span-110-2"><span class="o">[</span>root@192<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># vim /etc/dhcp/dhcpd.conf</span>
</span><span id="__span-110-3">allow<span class="w"> </span>booting<span class="p">;</span>
</span><span id="__span-110-4">allow<span class="w"> </span>bootp<span class="p">;</span>
</span><span id="__span-110-5">ddns-update-style<span class="w"> </span>none<span class="p">;</span>
</span><span id="__span-110-6">ignore<span class="w"> </span>client-updates<span class="p">;</span>
</span><span id="__span-110-7">subnet<span class="w"> </span><span class="m">192</span>.168.10.0<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.255.255.0<span class="w"> </span><span class="o">{</span>
</span><span id="__span-110-8"><span class="w">        </span>option<span class="w"> </span>subnet-mask<span class="w">                 </span><span class="m">255</span>.255.255.0<span class="p">;</span>
</span><span id="__span-110-9"><span class="w">        </span>option<span class="w"> </span>domain-name-servers<span class="w">         </span><span class="m">192</span>.168.10.10<span class="p">;</span>
</span><span id="__span-110-10"><span class="w">        </span>range<span class="w"> </span>dynamic-bootp<span class="w"> </span><span class="m">192</span>.168.10.100<span class="w"> </span><span class="m">192</span>.168.10.200<span class="p">;</span>
</span><span id="__span-110-11"><span class="w">        </span>default-lease-time<span class="w">                 </span><span class="m">21600</span><span class="p">;</span>
</span><span id="__span-110-12"><span class="w">        </span>max-lease-time<span class="w">                     </span><span class="m">43200</span><span class="p">;</span>
</span><span id="__span-110-13"><span class="w">        </span>next-server<span class="w">                        </span><span class="m">192</span>.168.10.10<span class="p">;</span>
</span><span id="__span-110-14"><span class="w">        </span>filename<span class="w">                           </span><span class="s2">&quot;pxelinux.0&quot;</span><span class="p">;</span>
</span><span id="__span-110-15"><span class="o">}</span>
</span></code></pre></div></td></tr></table></div></li>
<li>
<p>安装TFTP并配置
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-111-1"><span class="c1"># 安装</span>
</span><span id="__span-111-2"><span class="o">[</span>root@192<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># yum -y install tftp-server xinetd</span>
</span><span id="__span-111-3"><span class="c1"># 配置开启TFTP服务程序</span>
</span><span id="__span-111-4"><span class="o">[</span>root@192<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># vim /etc/xinetd.d/tftp</span>
</span><span id="__span-111-5"><span class="c1"># default: off</span>
</span><span id="__span-111-6"><span class="c1"># description: The tftp server serves files using the trivial file transfer \</span>
</span><span id="__span-111-7"><span class="c1">#   protocol.  The tftp protocol is often used to boot diskless \</span>
</span><span id="__span-111-8"><span class="c1">#   workstations, download configuration files to network-aware printers, \</span>
</span><span id="__span-111-9"><span class="c1">#   and to start the installation process for some operating systems.</span>
</span><span id="__span-111-10">service<span class="w"> </span>tftp
</span><span id="__span-111-11"><span class="o">{</span>
</span><span id="__span-111-12"><span class="w">    </span><span class="nv">socket_type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span>dgram
</span><span id="__span-111-13"><span class="w">    </span><span class="nv">protocol</span><span class="w">        </span><span class="o">=</span><span class="w"> </span>udp
</span><span id="__span-111-14"><span class="w">    </span><span class="nb">wait</span><span class="w">            </span><span class="o">=</span><span class="w"> </span>yes
</span><span id="__span-111-15"><span class="w">    </span><span class="nv">user</span><span class="w">            </span><span class="o">=</span><span class="w"> </span>root
</span><span id="__span-111-16"><span class="w">    </span><span class="nv">server</span><span class="w">          </span><span class="o">=</span><span class="w"> </span>/usr/sbin/in.tftpd
</span><span id="__span-111-17"><span class="w">    </span><span class="nv">server_args</span><span class="w">     </span><span class="o">=</span><span class="w"> </span>-s<span class="w"> </span>/var/lib/tftpboot
</span><span id="__span-111-18"><span class="w">    </span><span class="c1">#disable            = yes</span>
</span><span id="__span-111-19"><span class="w">    </span><span class="nv">disable</span><span class="w">         </span><span class="o">=</span><span class="w"> </span>no
</span><span id="__span-111-20"><span class="w">    </span><span class="nv">per_source</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="m">11</span>
</span><span id="__span-111-21"><span class="w">    </span><span class="nv">cps</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">2</span>
</span><span id="__span-111-22"><span class="w">    </span><span class="nv">flags</span><span class="w">           </span><span class="o">=</span><span class="w"> </span>IPv4
</span><span id="__span-111-23"><span class="o">}</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>配置syslinux服务程序
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-112-1"><span class="c1"># 安装</span>
</span><span id="__span-112-2"><span class="o">[</span>root@192<span class="w"> </span>yum.repos.d<span class="o">]</span><span class="c1"># yum -y install syslinux</span>
</span><span id="__span-112-3"><span class="c1"># 配置</span>
</span></code></pre></div></td></tr></table></div>
updating......................</p>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Peanut-1.0
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.indexes", "navigation.expand", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../mkdocs/javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>